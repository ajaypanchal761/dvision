import{u as M,r as n,j as e}from"./index-BPKQ2keO.js";import{n as j}from"./api-BdrZRD_7.js";const $=()=>{const g=M(),[N,v]=n.useState([]),[h,u]=n.useState(!0),[w,c]=n.useState(!1),[k,m]=n.useState(null),[f,y]=n.useState(""),[i,C]=n.useState(""),[s,L]=n.useState({page:1,pages:1,total:0,count:0});n.useEffect(()=>{x(1)},[]),n.useEffect(()=>{const t=setTimeout(()=>{i!==void 0&&x(1)},500);return()=>clearTimeout(t)},[i]);const p=t=>{t>=1&&t<=s.pages&&x(t)},x=async(t=1)=>{try{u(!0),y("");const r={page:t,limit:10};i&&(r.search=i);const a=await j.getAllCampaigns(r);a.success&&a.data?.campaigns&&(v(a.data.campaigns),L({page:a.page||1,pages:a.pages||1,total:a.total||0,count:a.count||0}))}catch(r){console.error("Error fetching campaigns:",r),y("Failed to load notifications. Please try again.")}finally{u(!1)}},T=t=>{m(t),c(!0)},A=async()=>{try{(await j.deleteCampaign(k)).success&&(alert("Notification deleted successfully!"),x(s.page),c(!1),m(null))}catch(t){console.error("Error deleting campaign:",t),alert(t.message||"Failed to delete notification. Please try again.")}},D=t=>t?new Date(t).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}):"N/A",b=N;return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pt-3 sm:pt-4 md:pt-5 lg:pt-6",children:[e.jsx("div",{className:"pb-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold text-[#1e3a5f]",children:"Manage Notifications"})}),e.jsxs("button",{onClick:()=>g("/admin/notifications/add"),className:"px-3 sm:px-4 md:px-5 lg:px-6 py-2 sm:py-2.5 md:py-3 bg-gradient-to-r from-[#1e3a5f] to-[#2a4a6f] hover:from-[#2a4a6f] hover:to-[#1e3a5f] text-white rounded-lg sm:rounded-xl font-semibold text-xs sm:text-sm md:text-base transition-all duration-200 flex items-center justify-center space-x-2 shadow-md hover:shadow-lg",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:"Add Notification"})]})]})}),f&&e.jsx("div",{className:"mt-3 sm:mt-4 bg-red-50 border border-red-200 text-red-700 px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm",children:f}),e.jsx("div",{className:"mt-3 sm:mt-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search notifications...",value:i,onChange:t=>C(t.target.value),className:"w-full px-3 sm:px-4 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none"}),e.jsx("svg",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),e.jsxs("div",{className:"mt-3 sm:mt-4 bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden",children:[h?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#1e3a5f] mx-auto"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-2",children:"Loading notifications..."})]}):b.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.002 2.002 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"No notifications found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 sm:px-3 py-2 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Recipient Type"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 text-left text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"px-2 sm:px-3 py-2 text-right text-[10px] sm:text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-2 sm:px-3 py-2",children:[e.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:t.title}),e.jsx("div",{className:"text-[10px] sm:text-xs text-gray-500 truncate max-w-xs",children:t.body})]}),e.jsx("td",{className:"px-2 sm:px-3 py-2",children:(()=>{const r=t.notificationType||(t.recipientTypes?t.recipientTypes.includes("student")&&t.recipientTypes.includes("teacher")?"both":t.recipientTypes.includes("student")?"students":"teachers":t.recipientType==="student"?"students":"teachers"),a=t.classNumber||t.filters?.class;let l="",o="",d="";return r==="students"?(l="Students",o="bg-blue-100",d="text-blue-700"):r==="teachers"?(l="Teachers",o="bg-purple-100",d="text-purple-700"):r==="both"?(l="Both",o="bg-green-100",d="text-green-700"):r==="class"&&(l=a?`Class ${a}`:"Class",o="bg-orange-100",d="text-orange-700"),e.jsx("span",{className:`px-2 py-1 rounded-lg text-[10px] sm:text-xs font-semibold ${o} ${d}`,children:l})})()}),e.jsx("td",{className:"px-2 sm:px-3 py-2 text-[10px] sm:text-xs text-gray-500",children:D(t.createdAt)}),e.jsx("td",{className:"px-2 sm:px-3 py-2 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[!t.sentAt&&e.jsx("button",{onClick:()=>g(`/admin/notifications/edit/${t._id}`),className:"p-1.5 text-[#1e3a5f] hover:bg-blue-50 rounded-lg transition-all duration-200",title:"Edit",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>T(t._id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200",title:"Delete",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},t._id))})]})}),!h&&s.pages>1&&e.jsxs("div",{className:"px-3 sm:px-4 py-3 sm:py-4 border-t border-gray-200 flex flex-col sm:flex-row items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-semibold",children:(s.page-1)*10+1})," to"," ",e.jsx("span",{className:"font-semibold",children:Math.min(s.page*10,s.total)})," ","of ",e.jsx("span",{className:"font-semibold",children:s.total})," notifications"]}),e.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[e.jsx("button",{onClick:()=>p(s.page-1),disabled:s.page===1,className:`px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium rounded-lg transition-all ${s.page===1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-[#1e3a5f] text-white hover:bg-[#2a4a6f]"}`,children:"Previous"}),e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:Math.min(5,s.pages)},(t,r)=>{let a;return s.pages<=5||s.page<=3?a=r+1:s.page>=s.pages-2?a=s.pages-4+r:a=s.page-2+r,e.jsx("button",{onClick:()=>p(a),className:`px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium rounded-lg transition-all ${s.page===a?"bg-[#1e3a5f] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:a},a)})}),e.jsx("button",{onClick:()=>p(s.page+1),disabled:s.page===s.pages,className:`px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm font-medium rounded-lg transition-all ${s.page===s.pages?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-[#1e3a5f] text-white hover:bg-[#2a4a6f]"}`,children:"Next"})]})]})]})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-4 sm:p-6 max-w-md w-full mx-4",children:[e.jsx("h3",{className:"text-sm sm:text-base font-bold text-gray-900 mb-2",children:"Delete Notification"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-4",children:"Are you sure you want to delete this notification? This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>{c(!1),m(null)},className:"px-3 sm:px-4 py-2 text-xs sm:text-sm border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-all duration-200",children:"Cancel"}),e.jsx("button",{onClick:A,className:"px-3 sm:px-4 py-2 text-xs sm:text-sm bg-red-600 text-white rounded-lg font-semibold hover:bg-red-700 transition-all duration-200",children:"Delete"})]})]})})]})};export{$ as default};
