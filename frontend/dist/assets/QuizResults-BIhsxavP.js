import{u as y,q as v,a as S,r as l,s as o,j as e,c as z,a7 as k,d as c}from"./index-BPKQ2keO.js";import{B as g}from"./BottomNav-KrGopomG.js";const E=()=>{const n=y(),{id:r}=v(),{user:b}=S(),[d,f]=l.useState(null),[t,h]=l.useState(null),[s,j]=l.useState([]),[N,u]=l.useState(!0),[p,i]=l.useState(null);l.useEffect(()=>{if(!r){console.error("Quiz ID is missing from URL"),n("/quizzes");return}w()},[r,n]);const w=async()=>{try{u(!0),i(null);const[m,x]=await Promise.all([o.getQuizById(r),o.getQuizLeaderboard(r).catch(a=>{if(a.status===403)return{success:!1,message:a.message};throw a})]);if(m.success&&m.data?.quiz&&f(m.data.quiz),x.success&&x.data)j(x.data.topStudents||[]),h(x.data.currentStudentSubmission);else{try{const a=await o.getSubmissionStatus(r);a.success&&a.data?.submission&&h(a.data.submission)}catch(a){console.error("Error fetching submission:",a)}i(x.message||"Results are not available yet")}}catch(m){console.error("Error fetching data:",m),i(m.message||"Failed to load results")}finally{u(!1)}};return N?e.jsxs("div",{className:"min-h-screen bg-white flex items-center justify-center pb-20",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 border-4 border-[var(--app-dark-blue)] border-t-transparent rounded-full animate-spin mx-auto mb-3 sm:mb-4"}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Loading results..."})]}),e.jsx(g,{})]}):e.jsxs("div",{className:"min-h-screen bg-white pb-20",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-3 sm:px-4 md:px-6 pt-3 sm:pt-4 md:pt-6 pb-4 sm:pb-6 md:pb-8",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>n(-1),className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(z,{className:"text-lg sm:text-xl md:text-2xl"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold",children:"Quiz Results"}),d&&e.jsx("p",{className:"text-xs sm:text-sm text-white/80 mt-0.5 sm:mt-1",children:d.name})]})]})})}),e.jsxs("main",{className:"px-3 sm:px-4 md:px-6 py-4 sm:py-5 md:py-6 pb-20 sm:pb-24",children:[p&&e.jsx("div",{className:"bg-yellow-50 border-2 border-yellow-200 rounded-lg sm:rounded-xl p-3 sm:p-4 mb-4 sm:mb-5 md:mb-6",children:e.jsx("p",{className:"text-yellow-800 text-xs sm:text-sm font-medium",children:p})}),e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-lg border border-gray-200 p-3 sm:p-4 md:p-5 mb-4 sm:mb-5 md:mb-6",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-4 sm:mb-5 md:mb-6",children:[e.jsx(k,{className:"text-[var(--app-dark-blue)] text-base sm:text-lg md:text-xl"}),e.jsx("h2",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold text-gray-800",children:"Leaderboard"})]}),s.length>0?e.jsxs("div",{className:"flex items-end justify-center gap-2 sm:gap-3 md:gap-4 lg:gap-6 mb-4 sm:mb-5 md:mb-6",children:[s.length>=2&&e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 rounded-full bg-gray-200 border-2 border-gray-300 flex items-center justify-center mb-1.5 sm:mb-2",children:e.jsx(c,{className:"text-gray-600 text-lg sm:text-xl md:text-2xl lg:text-3xl"})}),e.jsx("div",{className:"absolute -top-0.5 -right-0.5 sm:-top-1 sm:-right-1 w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 bg-gray-400 rounded-full flex items-center justify-center border-2 border-white shadow-md",children:e.jsx("span",{className:"text-white text-[10px] sm:text-xs font-bold",children:"2"})})]}),e.jsx("p",{className:"font-bold text-gray-800 text-[10px] sm:text-xs md:text-sm text-center mb-0.5 sm:mb-1",children:s[1]?.name||"Player Name"}),e.jsxs("p",{className:"font-bold text-gray-700 text-xs sm:text-sm md:text-base lg:text-lg",children:[s[1]?.score||0,"/",s[1]?.total||0]}),e.jsxs("p",{className:"text-gray-500 text-[10px] sm:text-xs",children:[s[1]?Math.round(s[1].score/s[1].total*100):0,"%"]}),s[1]?.points&&e.jsxs("p",{className:"text-[var(--app-dark-blue)] font-bold text-[10px] sm:text-xs mt-0.5",children:[s[1].points," pts"]})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 lg:w-28 lg:h-28 rounded-full bg-amber-200 border-2 sm:border-4 border-amber-400 flex items-center justify-center mb-1.5 sm:mb-2 shadow-lg",children:e.jsx(c,{className:"text-amber-700 text-xl sm:text-2xl md:text-3xl lg:text-4xl"})}),e.jsx("div",{className:"absolute -top-0.5 -right-0.5 sm:-top-1 sm:-right-1 w-6 h-6 sm:w-7 sm:h-7 md:w-8 md:h-8 bg-amber-500 rounded-full flex items-center justify-center border-2 border-white shadow-md",children:e.jsx("span",{className:"text-white text-xs sm:text-sm md:text-base font-bold",children:"1"})})]}),e.jsx("p",{className:"font-bold text-gray-800 text-xs sm:text-sm md:text-base lg:text-lg text-center mb-0.5 sm:mb-1",children:s[0]?.name||"Player Name"}),e.jsxs("p",{className:"font-bold text-amber-600 text-sm sm:text-base md:text-lg lg:text-xl",children:[s[0]?.score||0,"/",s[0]?.total||0]}),e.jsxs("p",{className:"text-gray-500 text-[10px] sm:text-xs",children:[s[0]?Math.round(s[0].score/s[0].total*100):0,"%"]}),s[0]?.points&&e.jsxs("p",{className:"text-amber-600 font-bold text-[10px] sm:text-xs mt-0.5",children:[s[0].points," pts"]})]}),s.length>=3&&e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 lg:w-24 lg:h-24 rounded-full bg-orange-200 border-2 border-orange-300 flex items-center justify-center mb-1.5 sm:mb-2",children:e.jsx(c,{className:"text-orange-600 text-lg sm:text-xl md:text-2xl lg:text-3xl"})}),e.jsx("div",{className:"absolute -top-0.5 -right-0.5 sm:-top-1 sm:-right-1 w-5 h-5 sm:w-6 sm:h-6 md:w-7 md:h-7 bg-orange-400 rounded-full flex items-center justify-center border-2 border-white shadow-md",children:e.jsx("span",{className:"text-white text-[10px] sm:text-xs font-bold",children:"3"})})]}),e.jsx("p",{className:"font-bold text-gray-800 text-[10px] sm:text-xs md:text-sm text-center mb-0.5 sm:mb-1",children:s[2]?.name||"Player Name"}),e.jsxs("p",{className:"font-bold text-gray-700 text-xs sm:text-sm md:text-base lg:text-lg",children:[s[2]?.score||0,"/",s[2]?.total||0]}),e.jsxs("p",{className:"text-gray-500 text-[10px] sm:text-xs",children:[s[2]?Math.round(s[2].score/s[2].total*100):0,"%"]}),s[2]?.points&&e.jsxs("p",{className:"text-[var(--app-dark-blue)] font-bold text-[10px] sm:text-xs mt-0.5",children:[s[2].points," pts"]})]})]}):e.jsx("div",{className:"text-center py-6 sm:py-8 text-gray-500",children:e.jsx("p",{className:"font-medium text-sm sm:text-base",children:"No results available yet"})})]}),t&&e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-lg border border-gray-200 p-3 sm:p-4 md:p-5",children:[e.jsx("div",{className:"mb-3 sm:mb-4 md:mb-5",children:e.jsx("h2",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold text-gray-800",children:"Your Performance"})}),e.jsx("div",{className:"border-2 border-gray-200 rounded-lg sm:rounded-xl p-3 sm:p-4 md:p-5 bg-gray-50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-gray-800 text-sm sm:text-base md:text-lg mb-0.5 sm:mb-1",children:b?.name||b?.fullName||"You"}),e.jsxs("p",{className:"text-gray-500 text-xs sm:text-sm",children:["Submitted: ",new Date(t.submittedAt).toLocaleString("en-IN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"text-center sm:text-right",children:[e.jsxs("p",{className:"font-bold text-[var(--app-dark-blue)] text-xl sm:text-2xl md:text-3xl lg:text-4xl",children:[t.score,"/",t.totalQuestions||d?.questions?.length||20]}),e.jsxs("p",{className:"text-gray-500 text-xs sm:text-sm mt-0.5 sm:mt-1",children:[Math.round(t.score/(t.totalQuestions||d?.questions?.length||20)*100),"%",t.rank&&` â€¢ Rank #${t.rank}`]}),t.points&&t.points>0&&e.jsxs("p",{className:"text-[var(--app-dark-blue)] font-bold text-sm sm:text-base md:text-lg mt-1 sm:mt-1.5",children:["ğŸ† ",t.points," Points Earned"]})]})]})})]})]}),e.jsx(g,{})]})};export{E as default};
