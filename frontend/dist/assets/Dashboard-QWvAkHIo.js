import{u as U,a as R,r as l,j as e,d as I,R as A,g as _,h as O,i as D,k as z,l as V,m as Y,n as J,o as W,s as G,p as Q}from"./index-BPKQ2keO.js";import{B as H}from"./BottomNav-KrGopomG.js";const ee=()=>{const r=U(),{user:i}=R(),[c,B]=l.useState(0),[f,m]=l.useState([]),[T,v]=l.useState(!0),[o,L]=l.useState("all"),[j,x]=l.useState([]),[w,N]=l.useState(0),[y,$]=l.useState(new Set),[u,h]=l.useState([]),C=async()=>{try{const s=await J.getUnreadCount();s.success&&s.data?.unreadCount!==void 0&&B(s.data.unreadCount)}catch(s){console.error("Error fetching unread count:",s)}};l.useEffect(()=>{C();const s=setInterval(()=>{C()},3e4);return()=>clearInterval(s)},[]);const S=l.useMemo(()=>[{image:"https://images.unsplash.com/photo-1509228468512-adae6b112b3e?w=1200&h=600&fit=crop&q=80",title:"Excel in Your Studies",subtitle:"Comprehensive courses designed for CBSE & RBSE students",description:"Learn from expert teachers and master every subject"},{image:"https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=1200&h=600&fit=crop&q=80",title:"Interactive Live Classes",subtitle:"Join real-time sessions with top educators",description:"Ask questions, get instant answers, and learn better"},{image:"https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?w=1200&h=600&fit=crop&q=80",title:"Practice Makes Perfect",subtitle:"Regular quizzes and assessments to track progress",description:"Test your knowledge and improve with every attempt"}],[]),P=async()=>{try{const s=await W.getPublic();s.success&&s.data?.banners?.length?h(s.data.banners):h([])}catch(s){console.error("Error fetching banners:",s),h([])}};l.useEffect(()=>{P()},[]);const d=l.useMemo(()=>u.length>0?u.map(s=>({image:s.image,title:s.title,subtitle:s.description||"",description:""})):S,[u,S]);l.useEffect(()=>{const s=setInterval(()=>{N(t=>(t+1)%d.length)},4e3);return()=>clearInterval(s)},[d.length]);const F=async()=>{try{const s=await Q.getUpcomingLiveClasses();s.success&&s.data?.liveClasses?x(s.data.liveClasses):x([])}catch(s){console.error("Error fetching upcoming live classes:",s),x([])}},p=l.useMemo(()=>[{id:"default-1",name:"Mathematics - Class 10",thumbnail:"https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=400&h=300&fit=crop",description:"Complete Mathematics course for Class 10",subject:"Mathematics",class:10,board:"CBSE",chapters:[],status:"Active",lectureCount:20},{id:"default-2",name:"Science - Class 10",thumbnail:"https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=400&h=300&fit=crop",description:"Complete Science course for Class 10",subject:"Science",class:10,board:"CBSE",chapters:[],status:"Active",lectureCount:15},{id:"default-3",name:"English - Class 10",thumbnail:"https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?w=400&h=300&fit=crop",description:"Complete English course for Class 10",subject:"English",class:10,board:"CBSE",chapters:[],status:"Active",lectureCount:18},{id:"default-4",name:"Social Studies - Class 10",thumbnail:"https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&h=300&fit=crop",description:"Complete Social Studies course for Class 10",subject:"Social Studies",class:10,board:"CBSE",chapters:[],status:"Active",lectureCount:12}],[]);l.useEffect(()=>{i&&((async()=>{try{v(!0);const t=await G.getCourses();if(t.success&&t.data?.courses&&t.data.courses.length>0){const n=t.data.courses.map(a=>(console.log("Course data:",{id:a._id,title:a.title,thumbnail:a.thumbnail,hasThumbnail:!!a.thumbnail}),{id:a._id,name:a.title,thumbnail:a.thumbnail||null,description:a.description||"",subject:a.subject,class:a.class,board:a.board,classId:a.classId,chapters:a.chapters||[],status:a.status,lectureCount:a.chapters?.length||0}));m(n)}else console.log("No courses from API, showing default courses"),m(p)}catch(t){console.error("Error fetching courses:",t),console.log("Error fetching courses, showing default courses"),m(p)}finally{v(!1)}})(),F())},[i,p]);const k=l.useMemo(()=>f,[f]),E=l.useMemo(()=>k.slice(0,2),[k]),b=l.useMemo(()=>i?i.activeSubscriptions&&i.activeSubscriptions.length>0&&i.activeSubscriptions.some(t=>t.endDate?new Date(t.endDate)>new Date:t.status==="active")?!0:i.subscription&&i.subscription.status==="active"?i.subscription.endDate?new Date(i.subscription.endDate)>new Date:!0:!1:!1,[i]),M=[{id:"live-classes",name:"Live Classes",icon:O,description:"Join interactive sessions"},{id:"courses",name:"Courses",icon:D,description:"Study materials & videos"},{id:"quizzes",name:"Quizzes",icon:z,description:"Test your knowledge"}];return e.jsxs("div",{className:"min-h-screen w-full bg-white",children:[e.jsx("div",{className:"bg-[var(--app-dark-blue)] text-white fixed top-0 left-0 right-0 z-50 px-3 sm:px-4 md:px-6 pt-6 sm:pt-8 md:pt-10 pb-3 sm:pb-4 md:pb-5 animate-fade-in",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>r(A.PROFILE),className:"hover:opacity-80 transition-opacity focus:outline-none",children:i?.profileImage?e.jsxs("div",{className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 rounded-full overflow-hidden border-2 border-white cursor-pointer hover:border-white/80 hover:scale-110 transition-all duration-300 pointer-events-none",children:[e.jsx("img",{src:i.profileImage,alt:"Profile",className:"w-full h-full object-cover pointer-events-none",onError:s=>{s.target.style.display="none",s.target.nextSibling.style.display="flex"}}),e.jsx("div",{className:"w-full h-full rounded-full bg-white/20 flex items-center justify-center hidden pointer-events-none",children:e.jsx(I,{className:"text-white text-base sm:text-lg md:text-xl"})})]}):e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 rounded-full bg-white/20 flex items-center justify-center cursor-pointer hover:bg-white/30 hover:scale-110 transition-all duration-300 pointer-events-none",children:e.jsx(I,{className:"text-white text-base sm:text-lg md:text-xl"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-xs sm:text-sm text-white/80 mb-0.5",children:"Welcome back,"}),e.jsx("span",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold",children:i?.fullName?.split(" ")[0]||i?.name?.split(" ")[0]||"Student"})]})]}),e.jsxs("button",{onClick:()=>r(A.NOTIFICATIONS),className:"relative p-1.5 sm:p-2 hover:bg-white/10 rounded-full transition-colors",children:[e.jsx(_,{className:"text-white text-lg sm:text-xl md:text-2xl"}),c>0&&e.jsx("span",{className:"absolute top-0.5 right-0.5 sm:top-1 sm:right-1 w-3 h-3 sm:w-3.5 sm:h-3.5 bg-red-500 rounded-full flex items-center justify-center border border-white animate-pulse-badge",children:e.jsx("span",{className:"text-white text-[8px] sm:text-[9px] font-bold",children:c>9?"9+":c})})]})]})}),e.jsx("header",{className:"bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsxs("div",{className:"px-3 sm:px-4 md:px-6 pt-20 sm:pt-24 md:pt-26 pb-4 sm:pb-6 md:pb-8",children:[e.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-medium mb-3 sm:mb-4 md:mb-5 leading-tight animate-slide-in-left text-center tracking-tight drop-shadow-lg",children:"Start Your Learning Adventure"}),e.jsx("div",{className:"flex gap-1.5 sm:gap-2 -mb-10 sm:-mb-12 md:-mb-14 relative z-10 justify-center",children:M.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>{L(s.id),s.id==="live-classes"?r("/live-classes"):s.id==="courses"?r("/my-courses"):s.id==="quizzes"&&r("/quizzes")},className:`flex flex-col items-center gap-0.5 sm:gap-1 p-3 sm:p-3.5 md:p-4 rounded-lg bg-white border-2 transition-all shadow-md hover:shadow-lg hover:scale-105 active:scale-95 w-[28%] sm:w-[30%] max-w-[140px] sm:max-w-[160px] md:max-w-[180px] ${o===s.id?"border-[var(--app-dark-blue)] shadow-lg bg-blue-50":"border-gray-200 hover:border-[var(--app-dark-blue)]/30"}`,children:[e.jsx("div",{className:`p-2 sm:p-2.5 md:p-3 rounded-full ${o===s.id?"bg-[var(--app-dark-blue)]":"bg-gray-100"}`,children:e.jsx(t,{className:`text-sm sm:text-base md:text-lg ${o===s.id?"text-white":"text-gray-600"}`})}),e.jsx("span",{className:`text-[10px] sm:text-xs md:text-sm font-bold ${o===s.id?"text-[var(--app-dark-blue)]":"text-gray-700"}`,children:s.name}),e.jsx("span",{className:"text-[9px] sm:text-[10px] md:text-xs text-gray-500 text-center leading-tight",children:s.description})]},s.id)})})]})}),e.jsxs("main",{className:"px-3 sm:px-4 md:px-6 pt-16 sm:pt-18 md:pt-20 pb-20 sm:pb-24",children:[!b&&e.jsxs("div",{className:"mb-4 sm:mb-5 md:mb-6 bg-white rounded-lg sm:rounded-xl p-6 sm:p-8 md:p-10 border-2 border-dashed border-gray-300 text-center",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-[var(--app-dark-blue)]/10 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(D,{className:"text-[var(--app-dark-blue)] text-3xl sm:text-4xl"})}),e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-800 mb-2 text-center",children:"No Subscription"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md mx-auto text-sm sm:text-base mb-6",children:"You need an active subscription to access courses, live classes, quizzes, and timetable. Please subscribe to a plan to continue learning."}),e.jsx("button",{onClick:()=>r("/subscription-plans"),className:"bg-[var(--app-dark-blue)] hover:bg-blue-700 text-white font-bold py-2.5 sm:py-3 px-6 sm:px-8 rounded-lg sm:rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl text-sm sm:text-base",children:"View Subscription Plans"})]}),b&&e.jsxs("div",{className:"mb-4 sm:mb-5 md:mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3 md:mb-4",children:[e.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-bold text-gray-800",children:"Available Courses"}),e.jsx("button",{onClick:()=>r("/my-courses"),className:"text-xs sm:text-sm text-gray-500 hover:text-[var(--app-dark-blue)] transition-colors",children:"See All"})]}),T?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--app-dark-blue)]"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading courses..."})]}):E.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600 text-lg",children:"No courses available."})}):e.jsx("div",{className:"grid grid-cols-2 gap-3 sm:gap-4",children:E.map((s,t)=>e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl overflow-hidden shadow-md hover:shadow-lg transition-shadow cursor-pointer w-full animate-fade-in-up",style:{animationDelay:`${t*.1}s`},onClick:()=>{s.id.startsWith("default-")?console.log("Default course clicked:",s.name):r(`/course/${s.id}`)},children:[e.jsxs("div",{className:"relative w-full h-28 sm:h-32 md:h-40 overflow-hidden bg-gray-100",children:[s.thumbnail?e.jsx("img",{src:s.thumbnail,alt:s.name,className:"w-full h-full object-cover",loading:"lazy",onError:n=>{n.target.style.display="none";const a=n.target.nextElementSibling;a&&(a.style.display="flex")}}):null,e.jsx("div",{className:`w-full h-full bg-gradient-to-br from-[var(--app-dark-blue)] to-blue-700 flex items-center justify-center ${s.thumbnail?"hidden":"flex"}`,children:e.jsx(z,{className:"text-white text-3xl sm:text-4xl"})})]}),e.jsxs("div",{className:"p-2.5 sm:p-3 md:p-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm md:text-base font-bold text-gray-800 mb-0.5 sm:mb-1 line-clamp-2",children:s.name}),e.jsxs("p",{className:"text-[10px] sm:text-xs text-gray-500",children:["Class ",s.class]})]})]},s.id))})]}),e.jsx("div",{className:"mb-4 sm:mb-5 md:mb-6",children:e.jsxs("div",{className:"relative w-full rounded-lg sm:rounded-xl md:rounded-2xl overflow-hidden shadow-lg",children:[e.jsx("div",{className:"relative h-36 sm:h-44 md:h-52 lg:h-64 overflow-hidden",children:d.map((s,t)=>e.jsxs("div",{className:`absolute inset-0 transition-opacity duration-700 ease-in-out ${t===w?"opacity-100":"opacity-0"}`,children:[e.jsx("img",{src:y.has(t)?"https://via.placeholder.com/1200x600/1e3a8a/ffffff?text=D%27Vision+Academy":s.image,alt:s.title,className:"w-full h-full object-cover",loading:"lazy",onError:n=>{y.has(t)?n.target.style.display="none":($(a=>new Set([...a,t])),n.target.src="https://via.placeholder.com/1200x600/1e3a8a/ffffff?text=D%27Vision+Academy")}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[var(--app-dark-blue)]/85 via-[var(--app-dark-blue)]/70 to-[var(--app-dark-blue)]/40"}),e.jsx("div",{className:"absolute inset-0 flex items-center px-4 sm:px-6 md:px-8 lg:px-12",children:e.jsxs("div",{className:"max-w-2xl animate-slide-in-up",children:[e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-extrabold text-white mb-2 sm:mb-3 leading-tight drop-shadow-lg",children:s.title}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg text-white font-semibold mb-2 sm:mb-3 drop-shadow-md",children:s.subtitle}),e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-white/95 font-medium drop-shadow-sm",children:s.description})]})})]},t))}),e.jsx("div",{className:"absolute bottom-3 sm:bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2 z-10",children:d.map((s,t)=>e.jsx("button",{onClick:()=>N(t),className:`h-2 rounded-full transition-all duration-300 ${t===w?"bg-white w-8 shadow-md":"bg-white/50 w-2 hover:bg-white/70"}`,"aria-label":`Go to banner ${t+1}`},t))})]})}),b&&e.jsxs("div",{className:"mb-4 sm:mb-5 md:mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3 md:mb-4",children:[e.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-bold text-gray-800",children:"Upcoming Live Classes"}),e.jsx("button",{onClick:()=>r("/live-classes"),className:"text-xs sm:text-sm text-gray-500 hover:text-[var(--app-dark-blue)] transition-colors",children:"See All"})]}),j.length===0?e.jsx("div",{className:"text-center py-6 sm:py-8",children:e.jsx("p",{className:"text-gray-600 text-sm sm:text-base md:text-lg",children:"No upcoming live classes."})}):e.jsx("div",{className:"space-y-3",children:j.map((s,t)=>{const n=new Date(s.scheduledStartTime),a=n.toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),q=n.toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0});let g=null;return s.scheduledEndTime&&(g=new Date(s.scheduledEndTime).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0})),e.jsx("div",{className:`bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 shadow-md hover:shadow-lg transition-all cursor-pointer border border-gray-200 ${t%2===0?"animate-slide-in-left":"animate-slide-in-right"}`,style:{animationDelay:`${t*.15}s`},onClick:()=>r(`/live-class/${s.id||s._id}`),children:e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-800 mb-1.5",children:s.title}),e.jsxs("p",{className:"text-gray-600 text-xs sm:text-sm mb-2.5 font-medium",children:[s.subject||"Subject"," Â· ",s.teacher||"Teacher"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"p-1 bg-[var(--app-dark-blue)]/10 rounded-lg",children:e.jsx(V,{className:"text-[var(--app-dark-blue)] text-xs"})}),e.jsx("span",{className:"font-medium",children:a})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"p-1 bg-[var(--app-dark-blue)]/10 rounded-lg",children:e.jsx(Y,{className:"text-[var(--app-dark-blue)] text-xs"})}),e.jsxs("span",{className:"font-medium",children:[q,g?` - ${g}`:""]})]})]})]}),e.jsx("div",{className:"px-3 py-2 text-xs sm:text-sm text-gray-500 font-medium",children:"Starts Soon"})]})},s.id||s._id)})})]})]}),e.jsx(H,{})]})};export{ee as default};
