import{at as w,au as p,av as v,aw as y,r as o,u as j,j as e,L as N}from"./index-BPKQ2keO.js";import{a as u}from"./api-BdrZRD_7.js";const k={apiKey:"AIzaSyBkanF8TuSNJWYZFHWd4zjlhJrr_N-_878",authDomain:"dvision-academy.firebaseapp.com",projectId:"dvision-academy",storageBucket:"dvision-academy.firebasestorage.app",messagingSenderId:"195388337660",appId:"1:195388337660:web:67f24b5c689a05755d5679"},S=y(k);let d=null;const F="BBM4rFMYzjANGeXwTEb7pAracML52yB8_63VC9TWy5Lq2P6waPNMCg7zY5WQIg198iXnat6HOx-mSKdjjXkae1A",x=()=>{if(typeof window<"u"&&"serviceWorker"in navigator){if(!d)try{d=v(S)}catch(s){console.error("Error initializing Firebase Messaging:",s)}return d}return null},M=async()=>{try{if(!("Notification"in window))return console.warn("This browser does not support notifications"),null;if(await Notification.requestPermission()==="granted"){console.log("Notification permission granted");const t=x();if(!t)return console.warn("Firebase Messaging not available"),null;try{const a=await w(t,{vapidKey:F});return a?(console.log("FCM Token:",a),a):(console.warn("No FCM token available"),null)}catch(a){return console.error("Error getting FCM token:",a),null}}else return console.warn("Notification permission denied"),null}catch(s){return console.error("Error requesting notification permission:",s),null}},E=()=>new Promise(s=>{const t=x();t&&p(t,a=>{console.log("Message received in foreground:",a),s(a)})}),I=async()=>{if("serviceWorker"in navigator)try{const s=await navigator.serviceWorker.register("/firebase-messaging-sw.js");return console.log("Service Worker registered:",s),s}catch(s){return console.error("Service Worker registration failed:",s),null}return null},C=async()=>{try{await I();const s=await M();return s?(await f(s),s):null}catch(s){return console.error("Error initializing notifications:",s),null}},f=async s=>{try{if(!localStorage.getItem("dvision_admin_token")){console.warn("User not logged in. FCM token will be saved after login."),localStorage.setItem("pending_fcm_token",s);return}await u.updateFcmToken(s,"web"),console.log("FCM token saved to backend"),localStorage.removeItem("pending_fcm_token")}catch(t){console.error("Error saving FCM token to backend:",t)}},z=async()=>{const s=localStorage.getItem("pending_fcm_token");s&&await f(s)},A=()=>{E().then(s=>{if(console.log("Foreground message received:",s),"Notification"in window&&Notification.permission==="granted"){const t=new Notification(s.notification?.title||"Dvision Academy",{body:s.notification?.body||"",icon:"/icon-192x192.png",badge:"/badge-72x72.png",data:s.data||{},tag:s.data?.tag||"default"});t.onclick=a=>{a.preventDefault();const l=s.data?.url||"/";window.open(l,"_blank"),t.close()}}}).catch(s=>{console.error("Error in foreground message listener:",s)})},W=()=>{const[s,t]=o.useState(""),[a,l]=o.useState(""),[g,c]=o.useState(""),[i,m]=o.useState(!1),h=j(),b=async n=>{n.preventDefault(),c(""),m(!0);try{const r=await u.login(s,a);r.success?(r.data?.admin&&localStorage.setItem("admin_data",JSON.stringify(r.data.admin)),C(),A(),z(),h("/admin/dashboard")):c(r.message||"Login failed. Please try again.")}catch(r){c(r.message||"Login failed. Please check your credentials and try again.")}finally{m(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-col lg:flex-row bg-white",children:[e.jsxs("div",{className:"hidden lg:flex w-full lg:w-1/2 bg-gradient-to-br from-[#1e3a5f] via-[#2a4a6f] to-[#1e3a5f] flex-col justify-between p-8 lg:p-12 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-10 right-10 w-32 h-32 bg-white/10 rounded-full blur-2xl"}),e.jsx("div",{className:"absolute bottom-20 left-10 w-40 h-40 bg-white/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 right-1/4 w-24 h-24 bg-white/10 rounded-full blur-xl"})]}),e.jsx("div",{className:"flex-1 flex items-start pt-8 lg:pt-16 relative z-10",children:e.jsxs("div",{className:"w-full max-w-lg",children:[e.jsxs("h1",{className:"text-4xl lg:text-5xl xl:text-6xl font-bold text-white leading-tight mb-4",children:["Create, Manage &"," ",e.jsx("span",{className:"text-[#FF6B35]",children:"Boost Your Business"})]}),e.jsx("p",{className:"text-lg lg:text-xl text-white/90 mt-6",children:"Streamline your operations and take your academy to the next level with our comprehensive admin panel."})]})}),e.jsx("div",{className:"mt-8 lg:mt-0 relative z-10",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-white/10 rounded-full blur-xl"}),e.jsx("img",{src:"/logo.png",alt:"D'Vision Academy Logo",className:"w-16 h-16 lg:w-20 lg:h-20 object-contain relative z-10"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl lg:text-2xl font-bold text-white",children:"D'VISION ACADEMY"}),e.jsx("p",{className:"text-sm lg:text-base text-white/80",children:"Empowering Education"})]})]})})]}),e.jsxs("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-4 sm:p-5 lg:p-6 bg-gray-50 lg:bg-white min-h-screen lg:min-h-0 relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-48 h-48 sm:w-64 sm:h-64 bg-[#1e3a5f]/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-60 h-60 sm:w-80 sm:h-80 bg-orange-500/5 rounded-full blur-3xl"})]}),e.jsx("div",{className:"w-full max-w-md mx-auto relative z-10",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-gray-100 p-5 sm:p-6 lg:p-7",children:[e.jsx("div",{className:"flex justify-center mb-4 lg:hidden",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[#1e3a5f]/20 rounded-full blur-2xl scale-150"}),e.jsx("img",{src:"/logo.png",alt:"D'Vision Academy Logo",className:"w-16 h-16 sm:w-20 sm:h-20 object-contain relative z-10"})]})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-900 mb-5 sm:mb-6 text-center lg:text-left",children:"Admin Sign-in"}),g&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-xs sm:text-sm text-red-600",children:g})}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5",children:"Email"}),e.jsx("input",{id:"email",type:"email",value:s,onChange:n=>t(n.target.value),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all text-sm text-gray-700 placeholder-gray-400 bg-gray-50 focus:bg-white",placeholder:"Enter your email",required:!0,disabled:i})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5",children:"Password"}),e.jsx("input",{id:"password",type:"password",value:a,onChange:n=>l(n.target.value),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all text-sm text-gray-700 placeholder-gray-400 bg-gray-50 focus:bg-white",placeholder:"Enter your password",required:!0,disabled:i})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(N,{to:"/admin/forgot-password",className:"text-xs sm:text-sm text-[#1e3a5f] hover:text-[#2a4a6f] font-semibold transition-colors",children:"Forgot password?"})}),e.jsx("button",{type:"submit",disabled:i,className:"w-full bg-[#1e3a5f] text-white py-2.5 sm:py-3 rounded-lg font-bold text-sm sm:text-base hover:bg-[#2a4a6f] hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none shadow-md",children:i?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 sm:h-5 sm:w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing in..."]}):"Login"})]})]})})]})]})};export{W as default};
