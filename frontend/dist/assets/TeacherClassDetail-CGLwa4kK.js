import{q as g,u as y,r as l,j as e,c as j,l as u,m as f,d as b,ax as N,Y as w}from"./index-BPKQ2keO.js";import{l as v}from"./api-BdrZRD_7.js";const n=(a,r=!0)=>a?new Date(a).toLocaleString("en-IN",{timeZone:"Asia/Kolkata",hour12:!0,day:"2-digit",month:"short",year:"numeric",...r?{hour:"2-digit",minute:"2-digit"}:{}}):"-",S=({status:a})=>{const r={live:"bg-green-100 text-green-700",scheduled:"bg-yellow-100 text-yellow-700",ended:"bg-gray-100 text-gray-700",cancelled:"bg-red-100 text-red-700"};return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${r[a]||"bg-gray-100 text-gray-700"}`,children:a||"unknown"})},L=()=>{const{id:a}=g(),r=y(),[s,o]=l.useState(null),[p,i]=l.useState(!1),[x,c]=l.useState(null);l.useEffect(()=>{(async()=>{try{i(!0),c(null);const d=await v.getById(a);o(d?.data?.liveClass||null)}catch(d){c(d?.message||"Failed to load live class")}finally{i(!1)}})()},[a]);const h=s?.studentCount||0,m=l.useMemo(()=>s?.studentsJoined?s.studentsJoined.map(t=>({...t,name:t.student?.name||"Student",phone:t.student?.phone||"—"})):[],[s]);return e.jsx("div",{className:"min-h-screen bg-white",children:e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pt-3 sm:pt-4 md:pt-5 lg:pt-6",children:[e.jsxs("button",{onClick:()=>r(-1),className:"inline-flex items-center gap-2 text-sm font-semibold text-[#1e3a5f] hover:text-[#162b46]",children:[e.jsx(j,{})," Back"]}),e.jsxs("div",{className:"mt-3 sm:mt-4 md:mt-5",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-900",children:s?.title||"Live class"}),e.jsx("p",{className:"text-gray-600 text-sm mt-1",children:s?.description||"Live class details"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(u,{})," ",n(s?.scheduledStartTime)]}),s?.endTime&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(f,{})," Ended: ",n(s.endTime)]})]})]}),e.jsx(S,{status:s?.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 mt-4",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(b,{})," Teacher"]}),e.jsx("p",{className:"text-gray-900 font-semibold",children:s?.teacher?.name||"-"}),e.jsx("p",{className:"text-gray-600 text-sm",children:s?.teacher?.email||s?.teacher?.phone||"—"})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(N,{})," Class & Subject"]}),e.jsx("p",{className:"text-gray-900 font-semibold",children:s?.class?.name||s?.class?.class||"-"}),e.jsx("p",{className:"text-gray-600 text-sm",children:s?.class?.board||""}),e.jsx("p",{className:"text-gray-800 text-sm mt-1",children:s?.subject?.name||"-"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-md mt-5",children:[e.jsx("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Students Joined"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[h," students"]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-3 sm:px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Left"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:p?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-6 text-center text-sm text-gray-600",children:"Loading students..."})}):x?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-6 text-center text-sm text-red-600",children:x})}):m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-6 text-center text-sm text-gray-600",children:"No students joined yet"})}):m.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 sm:px-4 py-3 whitespace-nowrap font-semibold text-gray-900",children:t.name}),e.jsxs("td",{className:"px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-gray-700 flex items-center gap-2",children:[e.jsx(w,{className:"text-gray-400"})," ",t.phone]}),e.jsx("td",{className:"px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:n(t.joinedAt)}),e.jsx("td",{className:"px-3 sm:px-4 py-3 whitespace-nowrap text-sm text-gray-700",children:t.leftAt?n(t.leftAt):"In class / —"})]},t.userId))})]})})]})]})]})})};export{L as default};
