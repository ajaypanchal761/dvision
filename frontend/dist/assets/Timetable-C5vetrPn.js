import{u as E,a as M,r as n,j as e,c as F,R as O,m as b,l as g,d as S,i as A,Z as $}from"./index-BPKQ2keO.js";import{B as L}from"./BottomNav-KrGopomG.js";const R=()=>{const j=E(),{hasActiveSubscription:C}=M(),[f,D]=n.useState([]),[N,m]=n.useState([]),[I,y]=n.useState(!0),[v,o]=n.useState(""),[l,w]=n.useState(null),x=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],p=x[new Date().getDay()===0?6:new Date().getDay()-1];n.useEffect(()=>{(async()=>{try{y(!0),o("");const t=await $.getMyClassTimetable();t.success&&t.data?(D(t.data.timetables||[]),t.data.classes&&Array.isArray(t.data.classes)?m(t.data.classes):t.data.class?m([t.data.class]):m([])):o("Failed to load timetable")}catch(t){console.error("Error fetching timetable:",t),o(t.message||"Failed to load timetable")}finally{y(!1)}})()},[]);const i=s=>{if(!s)return"N/A";const[t,a]=s.split(":"),r=parseInt(t),c=r>=12?"PM":"AM";return`${r%12||12}:${a} ${c}`},k=s=>f.filter(t=>t.dayOfWeek===s).sort((t,a)=>{const[r,c]=t.startTime.split(":").map(Number),[d,h]=a.startTime.split(":").map(Number);return r*60+c-(d*60+h)}),T=l?k(l):f.sort((s,t)=>{const a=x.indexOf(s.dayOfWeek)-x.indexOf(t.dayOfWeek);if(a!==0)return a;const[r,c]=s.startTime.split(":").map(Number),[d,h]=t.startTime.split(":").map(Number);return r*60+c-(d*60+h)}),u=s=>s?s.type==="preparation"?s.name:`Class ${s.class} - ${s.board}`:"N/A";return e.jsxs("div",{className:"min-h-screen w-full bg-white pb-20",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-4 sm:px-6 pt-3 sm:pt-4 pb-4 sm:pb-5",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("button",{onClick:()=>j(O.LIVE_CLASSES||"/live-classes"),className:"p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(F,{className:"text-lg sm:text-xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"My Timetable"}),N.length>0&&e.jsx("p",{className:"text-xs sm:text-sm text-white/90 mt-0.5",children:N.map(s=>u(s)).join(" • ")})]})]})})}),e.jsxs("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-4 sm:py-5",children:[e.jsx("div",{className:"mb-3 sm:mb-4",children:e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 overflow-x-auto pb-2",children:[e.jsx("button",{onClick:()=>w(null),className:`px-2.5 sm:px-3 py-1 sm:py-1.5 rounded-lg text-xs font-medium whitespace-nowrap transition-all ${l===null?"bg-[var(--app-dark-blue)] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Days"}),x.map(s=>e.jsxs("button",{onClick:()=>w(s),className:`px-2.5 sm:px-3 py-1 sm:py-1.5 rounded-lg text-xs font-medium whitespace-nowrap transition-all ${l===s?"bg-[var(--app-dark-blue)] text-white":s===p?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s.substring(0,3),s===p&&e.jsx("span",{className:"ml-0.5",children:"•"})]},s))]})}),I?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[250px]",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--app-dark-blue)] mb-2.5"}),e.jsx("p",{className:"text-gray-500 text-xs sm:text-sm",children:"Loading timetable..."})]}):v?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[250px] bg-white rounded-lg sm:rounded-xl p-4 sm:p-5",children:[e.jsx("div",{className:"w-14 h-14 bg-red-100 rounded-full flex items-center justify-center mb-3",children:e.jsx(b,{className:"text-red-600 text-xl"})}),e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-800 mb-1.5",children:"Error Loading Timetable"}),e.jsx("p",{className:"text-gray-500 text-center text-xs sm:text-sm mb-3",children:v}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-[var(--app-dark-blue)] text-white px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg text-xs sm:text-sm font-medium",children:"Retry"})]}):C?T.length>0?e.jsx("div",{className:"space-y-3",children:l?e.jsxs("div",{children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold text-gray-800 mb-2.5 sm:mb-3",children:l}),e.jsx("div",{className:"space-y-2.5 sm:space-y-3",children:T.map(s=>e.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 shadow-md border border-gray-200 hover:shadow-lg transition-all",children:e.jsxs("div",{className:"flex items-start gap-2.5 sm:gap-3",children:[s.thumbnail&&e.jsx("div",{className:"flex-shrink-0 w-14 h-14 sm:w-16 sm:h-16 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.thumbnail,alt:s.subjectId?.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[e.jsx("h3",{className:"text-sm sm:text-base font-bold text-gray-800",children:s.subjectId?.name||"Subject"}),s.topic&&e.jsxs("span",{className:"text-xs text-gray-500",children:["• ",s.topic]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[e.jsx(b,{className:"text-[var(--app-dark-blue)] text-xs"}),e.jsxs("span",{children:[i(s.startTime)," - ",i(s.endTime)]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[e.jsx(S,{className:"text-[var(--app-dark-blue)] text-xs"}),e.jsx("span",{children:s.teacherId?.name||"Teacher"})]}),s.classId&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-purple-600",children:[e.jsx(A,{className:"text-purple-600 text-xs"}),e.jsx("span",{className:"bg-purple-50 px-1.5 py-0.5 rounded text-purple-700 font-medium",children:u(s.classId)})]})]})]})]})},s._id))})]}):x.map(s=>{const t=k(s);return t.length===0?null:e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 shadow-md border border-gray-200",children:[e.jsxs("h2",{className:"text-sm sm:text-base font-bold text-gray-800 mb-2.5 sm:mb-3 flex items-center gap-1.5",children:[e.jsx(g,{className:"text-[var(--app-dark-blue)] text-sm"}),s,s===p&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-1.5 py-0.5 rounded-full font-medium",children:"Today"})]}),e.jsx("div",{className:"space-y-2 sm:space-y-2.5",children:t.map(a=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-2.5 sm:p-3 border border-gray-100",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-2.5",children:[a.thumbnail&&e.jsx("div",{className:"flex-shrink-0 w-12 h-12 sm:w-14 sm:h-14 rounded-lg overflow-hidden",children:e.jsx("img",{src:a.thumbnail,alt:a.subjectId?.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-bold text-gray-800",children:a.subjectId?.name||"Subject"}),a.topic&&e.jsxs("span",{className:"text-xs text-gray-500",children:["• ",a.topic]})]}),e.jsxs("div",{className:"space-y-0.5",children:[e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[e.jsx(b,{className:"text-[var(--app-dark-blue)] text-xs"}),e.jsxs("span",{children:[i(a.startTime)," - ",i(a.endTime)]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-gray-600",children:[e.jsx(S,{className:"text-[var(--app-dark-blue)] text-xs"}),e.jsx("span",{children:a.teacherId?.name||"Teacher"})]}),a.classId&&e.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-purple-600",children:[e.jsx(A,{className:"text-purple-600 text-xs"}),e.jsx("span",{className:"bg-purple-50 px-1.5 py-0.5 rounded text-purple-700 font-medium",children:u(a.classId)})]})]})]})]})},a._id))})]},s)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[250px] bg-white rounded-lg sm:rounded-xl p-4 sm:p-5",children:[e.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 bg-[var(--app-dark-blue)]/10 rounded-full flex items-center justify-center mb-3",children:e.jsx(g,{className:"text-[var(--app-dark-blue)] text-xl sm:text-2xl"})}),e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-800 mb-1.5",children:"No Timetable Available"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md text-xs sm:text-sm",children:l?`No classes scheduled for ${l}`:"Your class timetable has not been created yet. Please contact your administrator."})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[250px] bg-white rounded-lg sm:rounded-xl p-4 sm:p-5",children:[e.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 bg-[var(--app-dark-blue)]/10 rounded-full flex items-center justify-center mb-3",children:e.jsx(g,{className:"text-[var(--app-dark-blue)] text-xl sm:text-2xl"})}),e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-800 mb-1.5",children:"No Subscription"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md text-xs sm:text-sm mb-4",children:"You need an active subscription to access timetable. Please subscribe to a plan to continue learning."}),e.jsx("button",{onClick:()=>j("/subscription-plans"),className:"bg-[var(--app-dark-blue)] hover:bg-blue-700 text-white font-bold py-2.5 sm:py-3 px-6 sm:px-8 rounded-lg sm:rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl text-xs sm:text-sm md:text-base",children:"View Subscription Plans"})]})]}),e.jsx(L,{})]})};export{R as default};
