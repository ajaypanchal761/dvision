import{q as I,u as U,r,j as s,c as A,ao as M,ap as k,D as C,aq as $,ar as D,as as B,p as O}from"./index-BPKQ2keO.js";const H=()=>{const{id:u}=I(),x=U(),[l,w]=r.useState(null),[S,h]=r.useState(!0),[g,b]=r.useState(""),t=r.useRef(null),[i,d]=r.useState(!1),[c,p]=r.useState(0),[a,o]=r.useState(0),[v,E]=r.useState(1),[m,j]=r.useState(!1),[V,y]=r.useState("");r.useEffect(()=>{u&&(async()=>{try{h(!0);const n=await O.getLiveClass(u);n.success&&n.data.liveClass?w(n.data.liveClass):b("Recording not found.")}catch(n){b("Failed to load recording."),console.error(n)}finally{h(!1)}})()},[u]),r.useEffect(()=>{if(y(""),t.current&&l?.recording?.playbackUrl)try{const e=t.current;e.pause(),e.src=l.recording.playbackUrl,e.crossOrigin="anonymous",e.load()}catch(e){console.error("[Video] Error setting src:",e),y("Failed to load video")}},[l?.recording?.playbackUrl]);const f=()=>{t.current&&(i?t.current.pause():t.current.play(),d(!i))},z=()=>{t.current&&p(t.current.currentTime)},P=()=>{t.current&&o(t.current.duration)},R=e=>{t.current&&(t.current.currentTime=e.target.value,p(e.target.value))},q=e=>{t.current&&(t.current.playbackRate=e,E(e))},L=()=>{const e=document.getElementById("video-container");m?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),j(!m)},F=e=>{t.current&&(t.current.currentTime+=e)},N=e=>{if(!Number.isFinite(e)||isNaN(e)||e<=0)return"00:00";const n=Math.floor(e/60),T=Math.floor(e%60);return`${String(n).padStart(2,"0")}:${String(T).padStart(2,"0")}`};return r.useEffect(()=>{const e=()=>{j(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",e),()=>{document.removeEventListener("fullscreenchange",e)}},[]),S?s.jsx("div",{className:"flex items-center justify-center h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[var(--app-dark-blue)]"})}):g?s.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[s.jsx("p",{className:"text-red-500",children:g}),s.jsx("button",{onClick:()=>x(-1),className:"mt-4 px-4 py-2 bg-gray-200 rounded-lg",children:"Go Back"})]}):s.jsxs("div",{className:"bg-black text-white min-h-screen flex flex-col",children:[s.jsxs("header",{className:"px-4 py-3 flex items-center justify-between z-10 bg-gray-900",children:[s.jsx("button",{onClick:()=>x(-1),className:"p-2 rounded-full hover:bg-gray-800",children:s.jsx(A,{size:20})}),s.jsx("h1",{className:"text-lg font-bold",children:l?.title}),s.jsx("div",{className:"w-8"})]}),s.jsx("main",{className:"flex-1 flex items-center justify-center",children:s.jsxs("div",{id:"video-container",className:"w-full h-full relative group",children:[s.jsx("video",{ref:t,src:l?.recording?.playbackUrl,crossOrigin:"anonymous",playsInline:!0,onPlay:()=>d(!0),onPause:()=>d(!1),onTimeUpdate:z,onDurationChange:P,onLoadedMetadata:()=>{const e=t.current?.duration;Number.isFinite(e)&&!isNaN(e)?o(e):l?.recording?.duration?o(l.recording.duration):o(0);try{t.current&&(t.current.currentTime=0)}catch{}},onClick:f,style:{objectFit:"contain"},className:"w-full h-full"}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-opacity duration-300 flex items-center justify-center",children:s.jsxs("div",{className:"flex items-center space-x-8",children:[s.jsx("button",{onClick:()=>F(-10),className:"text-white p-2 rounded-full hover:bg-white/20",children:s.jsx(M,{size:32})}),s.jsx("button",{onClick:f,className:"text-white p-4 rounded-full bg-white/20 hover:bg-white/30",children:i?s.jsx(k,{size:48}):s.jsx(C,{size:48})}),s.jsx("button",{onClick:()=>F(10),className:"text-white p-2 rounded-full hover:bg-white/20",children:s.jsx($,{size:32})})]})}),s.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/70 to-transparent",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("button",{onClick:f,className:"text-white",children:i?s.jsx(k,{size:20}):s.jsx(C,{size:20})}),s.jsx("div",{className:"text-sm",children:N(c)}),s.jsx("input",{type:"range",min:"0",max:a||0,value:c,onChange:R,className:"w-full h-1 bg-white/30 rounded-full appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #3B82F6 ${a>0?c/a*100:0}%, #AFAFAF50 ${a>0?c/a*100:0}%)`}}),s.jsx("div",{className:"text-sm",children:N(a)}),s.jsxs("div",{className:"relative group/speed",children:[s.jsxs("button",{className:"text-white",children:[v,"x"]}),s.jsx("div",{className:"absolute bottom-full mb-2 right-0 bg-gray-800 rounded-md p-1 hidden group-hover/speed:block",children:[.5,1,1.5,2].map(e=>s.jsxs("button",{onClick:()=>q(e),className:`block w-full text-left px-2 py-1 text-sm ${v===e?"bg-blue-600":""}`,children:[e,"x"]},e))})]}),s.jsx("button",{onClick:L,className:"text-white",children:m?s.jsx(D,{size:20}):s.jsx(B,{size:20})})]})})]})})]})};export{H as default};
