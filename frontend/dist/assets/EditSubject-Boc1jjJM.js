import{u as j,q as v,r as i,j as e}from"./index-BPKQ2keO.js";import{c as y,e as p}from"./api-BdrZRD_7.js";const A=()=>{const n=j(),{id:o}=v(),[r,d]=i.useState({name:"",classId:"",isActive:!0}),[u,h]=i.useState([]),[c,x]=i.useState(!1),[f,m]=i.useState(!0),[b,l]=i.useState("");i.useEffect(()=>{(async()=>{try{m(!0);const t=await y.getAllWithoutPagination({isActive:!0});t.success&&t.data?.classes&&h(t.data.classes)}catch(t){console.error("Error fetching data:",t),l("Failed to load data. Please refresh the page.")}finally{m(!1)}})()},[]),i.useEffect(()=>{o&&(async()=>{if(o)try{m(!0),l("");const t=await p.getById(o);if(t.success&&t.data?.subject){const a=t.data.subject;d({name:a.name||"",classId:a.classId?._id||a.classId||"",isActive:a.isActive!==void 0?a.isActive:!0})}else l("Subject not found"),setTimeout(()=>n("/admin/subjects"),2e3)}catch(t){console.error("Error fetching subject:",t),l(t.message||"Failed to load subject data"),setTimeout(()=>n("/admin/subjects"),2e3)}finally{m(!1)}})()},[o,n]);const g=async s=>{s.preventDefault(),l(""),x(!0);const t={name:r.name.trim(),classId:r.classId,isActive:r.isActive};console.log("Updating subject data:",t);try{const a=await p.update(o,t);console.log("API Response:",a),a.success?n("/admin/subjects"):l(a.message||"Failed to update subject")}catch(a){console.error("Error updating subject:",a),l(a.message||"Failed to update subject. Please try again.")}finally{x(!1)}};return f?e.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 sm:h-10 sm:w-10 border-b-2 border-[#1e3a5f] mx-auto mb-2 sm:mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium text-xs sm:text-sm",children:"Loading subject data..."})]})}):e.jsx("div",{className:"min-h-screen bg-white",children:e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pt-2 sm:pt-3",children:[e.jsx("div",{className:"pb-1 sm:pb-2",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>n("/admin/subjects"),className:"text-[#1e3a5f] hover:text-[#2a4a6f] transition-colors",children:e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsx("h1",{className:"text-sm sm:text-base md:text-lg lg:text-xl font-bold text-[#1e3a5f]",children:"Edit Subject"})]})}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-lg text-xs sm:text-sm mt-2 sm:mt-3",children:b}),e.jsx("div",{className:"mt-2 sm:mt-3",children:e.jsxs("form",{onSubmit:g,className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-3 sm:p-4 md:p-5",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Class / Preparation Class ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:r.classId,onChange:s=>d({...r,classId:s.target.value}),className:"w-full px-3 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all duration-200 bg-white",disabled:c||u.length===0,children:[e.jsx("option",{value:"",children:"Select Class or Preparation Class"}),u.map(s=>{const t=s.type==="preparation"?`${s.name} (${s.classCode})`:`Class ${s.class} - ${s.board} (${s.classCode})`;return e.jsx("option",{value:s._id,children:t},s._id)})]}),u.length===0&&e.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:"No classes available. Please create a class first."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Subject Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:r.name,onChange:s=>d({...r,name:s.target.value}),className:"w-full px-3 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all duration-200",placeholder:"Enter subject name (e.g., Mathematics)",disabled:c})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:r.isActive?"Active":"Inactive",onChange:s=>d({...r,isActive:s.target.value==="Active"}),className:"w-full px-3 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all duration-200 bg-white",disabled:c,children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-2 sm:gap-3 pt-3 sm:pt-4",children:[e.jsx("button",{type:"button",onClick:()=>n("/admin/subjects"),disabled:c,className:"w-full sm:w-auto px-4 sm:px-6 py-2 text-xs sm:text-sm border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-all duration-200 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:c,className:"w-full sm:w-auto px-4 sm:px-6 py-2 text-xs sm:text-sm bg-gradient-to-r from-[#1e3a5f] to-[#2a4a6f] hover:from-[#2a4a6f] hover:to-[#1e3a5f] text-white rounded-lg font-semibold transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50",children:c?"Updating...":"Update Subject"})]})]})})]})})};export{A as default};
