import{u as E,r,j as e,c as F,ay as H,I as j,aL as A,a9 as B,y as L}from"./index-BPKQ2keO.js";import{B as T}from"./BottomNav-BGePCkyK.js";import{a as b}from"./api-CVReUq8b.js";const R=()=>{const v=E(),[D,p]=r.useState(!0),[g,N]=r.useState(!1),[h,f]=r.useState(!1),[a,u]=r.useState({bankDetails:null,upiId:null}),[x,i]=r.useState(!1),[n,c]=r.useState({accountHolderName:"",accountNumber:"",ifscCode:"",bankName:"",branchName:""}),[o,m]=r.useState(""),[k,l]=r.useState(""),[y,d]=r.useState("");r.useEffect(()=>{C()},[]);const C=async()=>{try{p(!0),l("");const t=await b.getMe();if(t.success&&t.data&&t.data.agent){const s=t.data.agent;u({bankDetails:s.bankDetails||null,upiId:s.upiId||null}),s.bankDetails?(c({accountHolderName:s.bankDetails.accountHolderName||"",accountNumber:s.bankDetails.accountNumber||"",ifscCode:s.bankDetails.ifscCode||"",bankName:s.bankDetails.bankName||"",branchName:s.bankDetails.branchName||""}),i(!1)):i(!0),m(s.upiId||"")}}catch(t){console.error("Error fetching agent data:",t),l(t.message||"Failed to load bank details")}finally{p(!1)}},w=async()=>{try{if(o&&!/^[\w.-]+@[\w.-]+$/.test(o)){l("Please provide a valid UPI ID (e.g., name@paytm)");return}if(x){if(!n.accountHolderName.trim()){l("Account Holder Name is required");return}if(!n.accountNumber.trim()){l("Account Number is required");return}if(!n.ifscCode.trim()){l("IFSC Code is required");return}if(!n.bankName.trim()){l("Bank Name is required");return}}N(!0),l(""),d("");const t=await b.updateMe({bankDetails:x?n:a.bankDetails,upiId:o||null});t.success?(u({bankDetails:t.data.agent.bankDetails,upiId:t.data.agent.upiId}),i(!1),d("Bank details saved successfully!"),setTimeout(()=>d(""),3e3)):l(t.message||"Failed to save bank details")}catch(t){l(t.message||"Failed to save bank details")}finally{N(!1)}},I=async()=>{if(confirm("Are you sure you want to delete your bank details? This action cannot be undone."))try{f(!0),l(""),d("");const t=await b.updateMe({bankDetails:null,upiId:null});t.success?(u({bankDetails:null,upiId:null}),c({accountHolderName:"",accountNumber:"",ifscCode:"",bankName:"",branchName:""}),m(""),i(!0),d("Bank details deleted successfully!"),setTimeout(()=>d(""),3e3)):l(t.message||"Failed to delete bank details")}catch(t){l(t.message||"Failed to delete bank details")}finally{f(!1)}},S=()=>{a.bankDetails?(c({accountHolderName:a.bankDetails.accountHolderName||"",accountNumber:a.bankDetails.accountNumber||"",ifscCode:a.bankDetails.ifscCode||"",bankName:a.bankDetails.bankName||"",branchName:a.bankDetails.branchName||""}),m(a.upiId||""),i(!1)):(c({accountHolderName:"",accountNumber:"",ifscCode:"",bankName:"",branchName:""}),m("")),l("")};return D?e.jsx("div",{className:"min-h-screen bg-white pb-20 sm:pb-24 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--app-dark-blue)]"}),e.jsx("p",{className:"mt-3 text-sm text-gray-600",children:"Loading bank details..."})]})}):e.jsxs("div",{className:"min-h-screen bg-white pb-20 sm:pb-24",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-3 sm:px-4 md:px-6 pt-3 sm:pt-4 md:pt-5 pb-4 sm:pb-5 md:pb-6",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>v(H.AGENT_PROFILE),className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(F,{className:"text-lg sm:text-xl md:text-2xl"})}),e.jsx("h1",{className:"text-sm sm:text-base md:text-lg lg:text-xl font-bold",children:"Bank Details"})]})})}),e.jsxs("div",{className:"px-3 sm:px-4 md:px-6 mt-3 sm:mt-4 md:mt-5",children:[y&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-3 py-2 rounded-lg text-xs sm:text-sm mb-4",children:y}),k&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-lg text-xs sm:text-sm mb-4",children:k}),e.jsxs("div",{className:"mb-4 sm:mb-5",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(j,{className:"text-blue-600 text-base sm:text-xl md:text-2xl"})}),e.jsxs("h2",{className:"text-sm sm:text-base md:text-lg lg:text-xl font-bold text-[var(--app-black)]",children:[x?a.bankDetails?"Edit":"Add":"View"," Bank Details"]})]}),x?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:["Account Holder Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.accountHolderName,onChange:t=>c(s=>({...s,accountHolderName:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-[var(--app-dark-blue)]",placeholder:"Enter account holder name"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:["Account Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.accountNumber,onChange:t=>c(s=>({...s,accountNumber:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-[var(--app-dark-blue)]",placeholder:"Enter account number"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:["IFSC Code ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.ifscCode,onChange:t=>c(s=>({...s,ifscCode:t.target.value.toUpperCase()})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-[var(--app-dark-blue)] uppercase",placeholder:"IFSC Code",maxLength:11})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:["Bank Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:n.bankName,onChange:t=>c(s=>({...s,bankName:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-[var(--app-dark-blue)]",placeholder:"Bank Name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"Branch Name"}),e.jsx("input",{type:"text",value:n.branchName,onChange:t=>c(s=>({...s,branchName:t.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-[var(--app-dark-blue)]",placeholder:"Enter branch name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-700 mb-1",children:"UPI ID"}),e.jsx("input",{type:"text",value:o,onChange:t=>m(t.target.value.toLowerCase()),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:outline-none focus:ring-2 focus:ring-[var(--app-dark-blue)]",placeholder:"e.g., name@paytm"})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs("button",{onClick:w,disabled:g,className:"flex-1 bg-[var(--app-dark-blue)] text-white py-2 rounded-lg text-xs sm:text-sm font-medium hover:opacity-90 disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(A,{className:"text-sm"}),g?"Saving...":"Save"]}),a.bankDetails&&e.jsx("button",{onClick:S,className:"flex-1 bg-gray-200 text-gray-700 py-2 rounded-lg text-xs sm:text-sm font-medium hover:bg-gray-300 flex items-center justify-center gap-2",children:"Cancel"})]})]}):e.jsxs("div",{className:"space-y-4",children:[a.bankDetails&&(a.bankDetails.accountHolderName||a.bankDetails.accountNumber)?e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 space-y-3",children:[a.bankDetails.accountHolderName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mb-1",children:"Account Holder Name"}),e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:a.bankDetails.accountHolderName})]}),a.bankDetails.accountNumber&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mb-1",children:"Account Number"}),e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:a.bankDetails.accountNumber})]}),a.bankDetails.ifscCode&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mb-1",children:"IFSC Code"}),e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:a.bankDetails.ifscCode})]}),a.bankDetails.bankName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mb-1",children:"Bank Name"}),e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:a.bankDetails.bankName})]}),a.bankDetails.branchName&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mb-1",children:"Branch Name"}),e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:a.bankDetails.branchName})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(j,{className:"text-4xl text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mb-4",children:"No bank details added yet"})]}),a.upiId&&e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-gray-700 mb-2",children:"UPI ID"}),e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-900",children:a.upiId})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs("button",{onClick:()=>i(!0),className:"flex-1 bg-[var(--app-dark-blue)] text-white py-2 rounded-lg text-xs sm:text-sm font-medium hover:opacity-90 flex items-center justify-center gap-2",children:[e.jsx(B,{className:"text-sm"}),a.bankDetails?"Edit":"Add"," Bank Details"]}),a.bankDetails&&e.jsxs("button",{onClick:I,disabled:h,className:"flex-1 bg-red-600 text-white py-2 rounded-lg text-xs sm:text-sm font-medium hover:bg-red-700 disabled:opacity-50 flex items-center justify-center gap-2",children:[e.jsx(L,{className:"text-sm"}),h?"Deleting...":"Delete"]})]})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 sm:p-4",children:e.jsxs("p",{className:"text-[10px] sm:text-xs text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," You can only have one bank details at a time. To add new bank details, you must delete the existing one first."]})})]}),e.jsx(T,{})]})};export{R as default};
