import{u as O,r as a,j as e,c as Y,ay as H,S as J,d as Q,m as W,J as F,a0 as X,a1 as G,T as P}from"./index-BPKQ2keO.js";import{B as K}from"./BottomNav-BGePCkyK.js";import{d as w}from"./api-CVReUq8b.js";const se=()=>{const T=O(),[y,E]=a.useState([]),[j,N]=a.useState(!0),[d,I]=a.useState(""),[x,M]=a.useState("all"),[r,i]=a.useState(null),[z,m]=a.useState(!1),[c,o]=a.useState(""),[f,k]=a.useState(!1),[S,p]=a.useState(null),[R,u]=a.useState(!1),[n,b]=a.useState(1),[v]=a.useState(10),[g,L]=a.useState(1),[C,U]=a.useState(0);a.useEffect(()=>{h()},[n,x]),a.useEffect(()=>{b(1);const s=setTimeout(()=>{h()},500);return()=>clearTimeout(s)},[d]);const h=async()=>{try{N(!0);const s={page:n,limit:v,search:d};x!=="all"&&(s.status=x);const l=await w.getAllDoubts(s);l.success&&(E(l.data.doubts||[]),L(l.pages||1),U(l.total||0))}catch(s){console.error("Error fetching doubts:",s)}finally{N(!1)}},$=s=>new Date(s).toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"}),q=s=>{i(s),o(s.answer||""),m(!0)},B=async()=>{if(!c.trim()){alert("Please enter an answer");return}try{k(!0),(await w.answerDoubt(r._id,c)).success&&(m(!1),i(null),o(""),await h(),alert(r?.answer?"Answer updated successfully!":"Answer submitted successfully!"))}catch(s){console.error("Error submitting answer:",s),alert(s.message||(r?.answer?"Failed to update answer. Please try again.":"Failed to submit answer. Please try again."))}finally{k(!1)}},_=async(s,l)=>{try{(await w.updateDoubtStatus(s,l)).success&&(await h(),alert("Status updated successfully!"))}catch(t){console.error("Error updating status:",t),alert(t.message||"Failed to update status. Please try again.")}},A=y;return e.jsxs("div",{className:"min-h-screen bg-white pb-20",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative animate-fade-in",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-3 sm:px-4 md:px-6 pt-3 sm:pt-4 md:pt-6 pb-4 sm:pb-6 md:pb-8",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>T(H.DASHBOARD),className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors hover:scale-110",children:e.jsx(Y,{className:"text-lg sm:text-xl md:text-2xl"})}),e.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold animate-slide-in-left",children:"Doubts"})]})})}),e.jsxs("main",{className:"px-3 sm:px-4 md:px-6 py-4 sm:py-5 md:py-6",children:[e.jsxs("div",{className:"mb-4 sm:mb-5 md:mb-6 space-y-3 sm:space-y-4 animate-fade-in",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 sm:left-4 top-1/2 transform -translate-y-1/2",children:e.jsx(J,{className:"text-gray-400 text-sm sm:text-base"})}),e.jsx("input",{type:"text",placeholder:"Search by question or student name...",value:d,onChange:s=>I(s.target.value),className:"w-full pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3 md:py-3.5 rounded-lg sm:rounded-xl border-2 border-gray-200 bg-white focus:outline-none focus:border-[var(--app-dark-blue)] focus:ring-2 focus:ring-[var(--app-dark-blue)]/20 transition-all text-sm sm:text-base shadow-sm hover:shadow-md focus:shadow-lg"})]}),e.jsx("div",{className:"flex gap-1.5 sm:gap-2 md:gap-3 flex-wrap",children:["all","Pending","Answered","Resolved"].map(s=>e.jsx("button",{onClick:()=>{M(s),b(1)},className:`px-3 sm:px-4 md:px-5 py-2 sm:py-2.5 md:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm md:text-base font-bold transition-all duration-300 hover:scale-105 ${x===s?"bg-gradient-to-r from-[var(--app-dark-blue)] to-blue-700 text-white shadow-lg hover:shadow-xl scale-105":"bg-white border-2 border-gray-200 text-gray-700 hover:border-[var(--app-dark-blue)]/30 hover:bg-gray-50 hover:shadow-md"}`,children:s},s))})]}),j?e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[var(--app-dark-blue)] border-t-transparent rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600 text-base font-semibold",children:"Loading doubts..."})]}):A.length>0?e.jsx("div",{className:"space-y-3 sm:space-y-4",children:A.map((s,l)=>e.jsxs("div",{className:`relative bg-gradient-to-br from-white via-white to-gray-50/30 rounded-xl border border-gray-200/80 transition-all duration-300 transform hover:scale-[1.02] hover:-translate-y-2 ${l%2===0?"animate-slide-in-left":"animate-slide-in-right"}`,style:{animationDelay:`${l*.15}s`,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(0, 0, 0, 0.05), 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05), inset 0 1px 0 0 rgba(255, 255, 255, 0.8)"},onMouseEnter:t=>{t.currentTarget.style.boxShadow="0 20px 25px -5px rgba(0, 0, 0, 0.15), 0 10px 10px -5px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(30, 58, 138, 0.3), 0 25px 50px -12px rgba(0, 0, 0, 0.3), inset 0 1px 0 0 rgba(255, 255, 255, 0.9)",t.currentTarget.style.borderColor="rgba(30, 58, 138, 0.3)"},onMouseLeave:t=>{t.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06), 0 0 0 1px rgba(0, 0, 0, 0.05), 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05), inset 0 1px 0 0 rgba(255, 255, 255, 0.8)",t.currentTarget.style.borderColor="rgba(0, 0, 0, 0.1)"},children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-gradient-to-r from-transparent via-white/60 to-transparent rounded-t-xl pointer-events-none z-10"}),e.jsx("div",{className:"px-3 sm:px-4 py-3 sm:py-3.5 relative z-0",children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[s.studentId&&e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-1.5",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gradient-to-br from-[var(--app-dark-blue)] to-blue-600 flex items-center justify-center shadow-md flex-shrink-0",children:e.jsx(Q,{className:"text-white text-xs sm:text-sm font-bold"})}),e.jsx("p",{className:"text-sm sm:text-base font-bold text-gray-800 truncate",children:s.studentId.name||"Unknown Student"})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-gray-500 text-[10px] sm:text-xs mb-1.5",children:[e.jsx(W,{className:"text-[var(--app-dark-blue)] text-xs"}),e.jsx("span",{className:"font-medium",children:$(s.createdAt)})]}),e.jsx("div",{className:"mb-2",children:e.jsx("h3",{className:"text-xs sm:text-sm font-bold text-gray-800 leading-snug sm:leading-relaxed line-clamp-2",children:s.question})}),s.answer&&e.jsx("div",{className:"mb-2 p-2 sm:p-2.5 bg-gradient-to-br from-blue-50 to-blue-100/50 rounded-md sm:rounded-lg border border-blue-200",children:e.jsx("p",{className:"text-gray-800 text-[10px] sm:text-xs leading-snug sm:leading-relaxed font-medium line-clamp-2",children:s.answer})}),e.jsxs("div",{className:"flex gap-1.5 sm:gap-2 pt-2 border-t border-gray-100",children:[e.jsxs("button",{onClick:()=>q(s),className:"group relative overflow-hidden flex-1 bg-gradient-to-r from-[var(--app-dark-blue)] via-[var(--app-dark-blue)] to-blue-700 hover:from-blue-700 hover:via-[var(--app-dark-blue)] hover:to-[var(--app-dark-blue)] text-white font-bold py-1.5 sm:py-2 rounded-md sm:rounded-lg transition-all duration-300 shadow-md hover:shadow-lg hover:scale-105 flex items-center justify-center gap-1 text-[10px] sm:text-xs",children:[e.jsxs("span",{className:"relative z-10 flex items-center gap-1",children:[e.jsx(F,{className:"text-xs group-hover:scale-110 transition-transform duration-300"}),e.jsx("span",{children:s.answer?"Edit":"Answer"})]}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"})]}),e.jsxs("select",{value:s.status,onChange:t=>_(s._id,t.target.value),className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-md sm:rounded-lg border-2 border-gray-200 bg-white text-[10px] sm:text-xs font-bold text-gray-700 focus:outline-none focus:border-[var(--app-dark-blue)] focus:ring-2 focus:ring-[var(--app-dark-blue)]/20 cursor-pointer hover:border-[var(--app-dark-blue)]/50 transition-all shadow-sm hover:shadow-md",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Answered",children:"Answered"}),e.jsx("option",{value:"Resolved",children:"Resolved"})]})]})]}),s.images&&s.images.length>0&&e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"flex flex-col gap-1.5 sm:gap-2",children:[s.images.slice(0,3).map((t,D)=>e.jsx("div",{className:"relative",children:e.jsx("img",{src:t,alt:`Doubt image ${D+1}`,className:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 object-cover rounded-md sm:rounded-lg border-2 border-gray-200 cursor-pointer hover:scale-105 transition-transform shadow-sm",onClick:()=>{p(t),u(!0)}})},D)),s.images.length>3&&e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-md sm:rounded-lg border-2 border-gray-200 bg-gray-100 flex items-center justify-center cursor-pointer hover:bg-gray-200 transition-colors shadow-sm",onClick:()=>{p(s.images[3]),u(!0)},children:e.jsxs("span",{className:"text-[10px] sm:text-xs font-bold text-gray-600",children:["+",s.images.length-3]})})]})})]})})]},s._id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-[var(--app-dark-blue)]/10 to-blue-50 rounded-full flex items-center justify-center mb-6 shadow-lg",children:e.jsx(F,{className:"text-[var(--app-dark-blue)] text-5xl"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2 text-center",children:d?"No doubts found":"No doubts yet"}),e.jsx("p",{className:"text-gray-600 text-base font-medium text-center max-w-md",children:d?"Try adjusting your search or filters.":"When students ask doubts, they will appear here."})]})]}),!j&&y.length>0&&e.jsx("div",{className:"px-3 sm:px-4 md:px-6 mb-20 sm:mb-24",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 bg-white p-4 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"text-sm text-gray-500 font-medium",children:["Showing ",e.jsx("span",{className:"font-bold text-gray-900",children:(n-1)*v+1})," to ",e.jsx("span",{className:"font-bold text-gray-900",children:Math.min(n*v,C)})," of ",e.jsx("span",{className:"font-bold text-gray-900",children:C})," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>b(s=>Math.max(1,s-1)),disabled:n===1,className:`p-2 rounded-lg border flex items-center gap-1 transition-all ${n===1?"border-gray-200 text-gray-300 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-[var(--app-dark-blue)] hover:text-white hover:border-[var(--app-dark-blue)]"}`,children:[e.jsx(X,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline font-medium",children:"Previous"})]}),e.jsx("div",{className:"flex items-center gap-1 px-2",children:e.jsxs("span",{className:"text-sm font-medium text-gray-700 bg-gray-50 px-3 py-1 rounded-md border border-gray-200",children:["Page ",n," of ",g]})}),e.jsxs("button",{onClick:()=>b(s=>Math.min(g,s+1)),disabled:n===g,className:`p-2 rounded-lg border flex items-center gap-1 transition-all ${n===g?"border-gray-200 text-gray-300 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-[var(--app-dark-blue)] hover:text-white hover:border-[var(--app-dark-blue)]"}`,children:[e.jsx("span",{className:"hidden sm:inline font-medium",children:"Next"}),e.jsx(G,{className:"w-5 h-5"})]})]})]})}),z&&r&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-3 sm:px-4",onClick:()=>{m(!1),i(null),o("")},children:e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl max-w-2xl w-full shadow-2xl max-h-[90vh] flex flex-col overflow-hidden",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"overflow-y-auto flex-1 px-3 sm:px-4 md:px-5 pt-3 sm:pt-4 pb-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[e.jsx("h2",{className:"text-sm sm:text-base md:text-lg font-bold text-gray-800",children:r.answer?"Edit Answer":"Answer Doubt"}),e.jsx("button",{onClick:()=>{m(!1),i(null),o("")},className:"p-1.5 sm:p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(P,{className:"text-gray-600 text-base sm:text-lg"})})]}),e.jsxs("div",{className:"mb-2 sm:mb-3",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-600 mb-1 font-medium",children:"Question:"}),e.jsx("p",{className:"text-xs sm:text-sm font-bold text-gray-800",children:r.question})]}),r.answer&&e.jsxs("div",{className:"mb-2 sm:mb-3 p-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-blue-700 font-medium mb-0.5",children:"Current Answer:"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-blue-900",children:r.answer})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] sm:text-xs font-bold text-gray-700 mb-1.5",children:r.answer?"Update Your Answer":"Your Answer"}),e.jsx("textarea",{value:c,onChange:s=>o(s.target.value),rows:"6",className:"w-full px-2.5 sm:px-3 py-2 sm:py-2.5 rounded-lg border-2 border-gray-200 bg-white focus:outline-none focus:border-[var(--app-dark-blue)] focus:ring-2 focus:ring-[var(--app-dark-blue)]/20 transition-all resize-none text-xs sm:text-sm",placeholder:r.answer?"Update your answer here...":"Enter your answer here...",autoFocus:r.answer})]})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3 p-3 sm:p-4 pt-2 sm:pt-3 border-t border-gray-200 bg-white",children:[e.jsx("button",{onClick:()=>{m(!1),i(null),o("")},className:"flex-1 bg-white border-2 border-gray-300 text-gray-700 font-semibold sm:font-bold py-2 sm:py-2.5 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-all shadow-sm hover:shadow-md text-xs sm:text-sm",children:"Cancel"}),e.jsxs("button",{onClick:B,disabled:f||!c.trim(),className:"group relative overflow-hidden flex-1 bg-gradient-to-r from-[var(--app-dark-blue)] via-[var(--app-dark-blue)] to-blue-700 hover:from-blue-700 hover:via-[var(--app-dark-blue)] hover:to-[var(--app-dark-blue)] text-white font-semibold sm:font-bold py-2 sm:py-2.5 rounded-lg transition-all duration-300 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed text-xs sm:text-sm",children:[e.jsx("span",{className:"relative z-10",children:f?r?.answer?"Updating...":"Submitting...":r?.answer?"Update Answer":"Submit Answer"}),!f&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent translate-x-[-100%] group-hover:translate-x-[100%] transition-transform duration-700"})]})]})]})}),R&&S&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 px-4 py-4",onClick:()=>{u(!1),p(null)},children:e.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full h-full flex items-center justify-center",children:[e.jsx("button",{onClick:()=>{u(!1),p(null)},className:"absolute top-4 right-4 z-10 bg-white/90 hover:bg-white text-gray-800 p-3 rounded-full shadow-xl transition-all hover:scale-110",children:e.jsx(P,{className:"text-xl font-bold"})}),e.jsx("img",{src:S,alt:"Doubt image",className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl",onClick:s=>s.stopPropagation()})]})}),e.jsx(K,{})]})};export{se as default};
