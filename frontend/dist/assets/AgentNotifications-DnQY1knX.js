import{u as L,r as n,j as e,c as z,ay as U,y as q,z as H,A as S,B as C,g as F,C as O,d as P,aa as Y}from"./index-BPKQ2keO.js";import{n as p}from"./api-CVReUq8b.js";import{B as G}from"./BottomNav-BGePCkyK.js";const Q=()=>{const g=L(),[l,h]=n.useState([]),[a,m]=n.useState([]),[u,v]=n.useState(!0),[x,o]=n.useState(!1),[D,b]=n.useState(!1),[w,i]=n.useState(""),[r,f]=n.useState(!1),A=s=>{const t=new Date(s),y=new Date-t,c=Math.floor(y/6e4),N=Math.floor(y/36e5),j=Math.floor(y/864e5);return c<1?"Just now":c<60?`${c} minute${c>1?"s":""} ago`:N<24?`${N} hour${N>1?"s":""} ago`:j<7?`${j} day${j>1?"s":""} ago`:t.toLocaleDateString()},k=async()=>{try{v(!0),i("");const s=await p.getMyNotifications();if(s.success&&s.data?.notifications){if(h(s.data.notifications),s.data.notifications.length>0){const t=s.data.notifications.filter(d=>!d.isRead).map(d=>d._id);t.length>0&&await p.markAsRead(t)}}else i("Failed to load notifications")}catch(s){const t=s?.message||s?.toString()||"Failed to load notifications";i(typeof t=="string"?t:"Failed to load notifications")}finally{v(!1)}};n.useEffect(()=>{k()},[]);const _=()=>{a.length===l.length?m([]):m(l.map(s=>s._id))},M=s=>{m(t=>t.includes(s)?t.filter(d=>d!==s):[...t,s])},$=async()=>{if(a.length!==0)try{o(!0),(await p.deleteNotifications(a)).success?(h(t=>t.filter(d=>!a.includes(d._id))),m([]),b(!1),f(!1)):i("Failed to delete notifications")}catch(s){const t=s?.message||s?.toString()||"Failed to delete notifications";i(typeof t=="string"?t:"Failed to delete notifications")}finally{o(!1)}},R=()=>{f(!0),m([])},E=()=>{f(!1),m([])},B=async()=>{try{o(!0),(await p.deleteAllNotifications()).success?(h([]),m([]),b(!1)):i("Failed to delete all notifications")}catch(s){const t=s?.message||s?.toString()||"Failed to delete all notifications";i(typeof t=="string"?t:"Failed to delete all notifications")}finally{o(!1)}},I=s=>{r||(s.data?.url?g(s.data.url):(s.type==="student_registered"||s.type==="student_subscribed")&&g("/agent/referrals"))},T=s=>s==="student_registered"?e.jsx(P,{className:"text-green-600"}):s==="student_subscribed"?e.jsx(Y,{className:"text-blue-600"}):e.jsx(F,{className:"text-gray-600"});return e.jsxs("div",{className:"min-h-screen w-full bg-white",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-3 sm:px-4 md:px-6 pt-3 sm:pt-4 md:pt-5 pb-4 sm:pb-5 md:pb-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("button",{onClick:()=>g(U.AGENT_DASHBOARD),className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors flex-shrink-0",children:e.jsx(z,{className:"text-lg sm:text-xl md:text-2xl"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-sm sm:text-base md:text-lg lg:text-xl font-bold",children:"Notifications"}),l.length>0&&!r&&e.jsxs("p",{className:"text-[10px] sm:text-xs md:text-sm text-white/80 mt-0.5",children:[l.length," notification",l.length>1?"s":""]}),r&&a.length>0&&e.jsxs("p",{className:"text-[10px] sm:text-xs md:text-sm text-white/80 mt-0.5",children:[a.length," selected"]})]})]}),e.jsx("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0",children:l.length>0&&e.jsx(e.Fragment,{children:r?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:E,className:"px-2 sm:px-3 py-1 sm:py-1.5 md:py-2 text-white hover:bg-white/10 rounded-lg text-[10px] sm:text-xs md:text-sm font-semibold transition-colors border border-white/20",children:"Cancel"}),a.length>0&&e.jsx("button",{onClick:$,disabled:x,className:"px-2 sm:px-3 py-1 sm:py-1.5 md:py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-[10px] sm:text-xs md:text-sm font-semibold transition-colors disabled:opacity-50 shadow-lg",children:x?"Deleting...":`Delete (${a.length})`})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:R,className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors",title:"Select to Delete",children:e.jsx(q,{className:"text-base sm:text-lg md:text-xl"})}),e.jsx("button",{onClick:k,disabled:u,className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors disabled:opacity-50",title:"Refresh",children:e.jsx(H,{className:`text-base sm:text-lg md:text-xl ${u?"animate-spin":""}`})})]})})})]})})}),e.jsxs("main",{className:"px-3 sm:px-4 md:px-6 py-3 sm:py-4 md:py-6 pb-20 sm:pb-24",children:[w&&e.jsx("div",{className:"mb-3 sm:mb-4 bg-red-50 border-2 border-red-200 text-red-700 px-3 sm:px-4 py-2 sm:py-3 rounded-xl text-[10px] sm:text-xs md:text-sm font-medium",children:w}),u?e.jsx("div",{className:"space-y-2 sm:space-y-3",children:[1,2,3].map(s=>e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 sm:p-4 md:p-5 animate-pulse",children:[e.jsx("div",{className:"h-3 sm:h-4 bg-gray-200 rounded w-3/4 mb-2 sm:mb-3"}),e.jsx("div",{className:"h-2.5 sm:h-3 bg-gray-200 rounded w-full mb-1.5 sm:mb-2"}),e.jsx("div",{className:"h-2.5 sm:h-3 bg-gray-200 rounded w-1/2"})]},s))}):l.length>0?e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[r&&e.jsx("div",{className:"flex items-center justify-between mb-2 sm:mb-3 md:mb-4",children:e.jsxs("button",{onClick:_,className:"flex items-center gap-1.5 sm:gap-2 text-gray-700 hover:text-[var(--app-dark-blue)] transition-colors font-bold",children:[a.length===l.length?e.jsx(S,{className:"text-lg sm:text-xl text-[var(--app-dark-blue)]"}):e.jsx(C,{className:"text-lg sm:text-xl"}),e.jsx("span",{className:"text-[11px] sm:text-xs md:text-sm",children:a.length===l.length?"Deselect All":"Select All"})]})}),l.map(s=>{const t=a.includes(s._id);return e.jsx("div",{className:`bg-white rounded-xl p-3 sm:p-4 md:p-5 shadow-md border-2 transition-all ${r?"cursor-pointer":s.type==="student_registered"||s.type==="student_subscribed"?"cursor-pointer hover:shadow-lg":""} ${t?"border-[var(--app-dark-blue)] ring-2 ring-[var(--app-dark-blue)]/20 bg-blue-50":"border-gray-200 hover:border-[var(--app-dark-blue)]/30"} ${s.isRead?"":"bg-[var(--app-dark-blue)]/5"}`,onClick:()=>{r?M(s._id):I(s)},children:e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[r&&e.jsx("div",{className:"mt-0.5 sm:mt-1",children:t?e.jsx(S,{className:"text-[var(--app-dark-blue)] text-lg sm:text-xl"}):e.jsx(C,{className:"text-gray-300 text-lg sm:text-xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-1.5 sm:mb-2",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-gray-100 rounded-lg",children:T(s.type)}),e.jsx("h3",{className:`font-bold text-[13px] sm:text-sm md:text-base flex-1 ${s.isRead?"text-gray-800":"text-[var(--app-dark-blue)]"}`,children:s.title}),!s.isRead&&e.jsx("span",{className:"w-1.5 h-1.5 sm:w-2 sm:h-2 bg-[var(--app-dark-blue)] rounded-full"})]}),e.jsx("p",{className:"text-gray-600 text-[11px] sm:text-xs md:text-sm mb-1.5 sm:mb-2 leading-relaxed",children:s.body}),s.type==="student_registered"&&s.data&&e.jsxs("div",{className:"bg-green-50 rounded-lg p-1.5 sm:p-2 mb-1.5 sm:mb-2 text-[10px] sm:text-xs",children:[e.jsxs("p",{className:"text-green-700 font-semibold",children:["ðŸ‘¤ ",s.data.studentName||"Student"]}),s.data.studentClass&&s.data.studentBoard&&e.jsxs("p",{className:"text-gray-600 mt-0.5 sm:mt-1",children:["ðŸ“š Class ",s.data.studentClass," - ",s.data.studentBoard]})]}),s.type==="student_subscribed"&&s.data&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-1.5 sm:p-2 mb-1.5 sm:mb-2 text-[10px] sm:text-xs",children:[e.jsxs("p",{className:"text-blue-700 font-semibold",children:["ðŸ’° ",s.data.studentName||"Student"," subscribed to ",s.data.planName||"Plan"]}),e.jsxs("p",{className:"text-gray-600 mt-0.5 sm:mt-1",children:["ðŸ’µ Amount: â‚¹",s.data.amount||"0"]})]}),e.jsx("p",{className:"text-gray-400 text-[10px] sm:text-xs font-medium",children:A(s.createdAt)})]})]})},s._id)})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-200px)] py-8 sm:py-12",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-[var(--app-dark-blue)]/10 rounded-full flex items-center justify-center mb-4 sm:mb-6",children:e.jsx(F,{className:"text-[var(--app-dark-blue)] text-3xl sm:text-4xl"})}),e.jsx("h2",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold text-gray-800 mb-1.5 sm:mb-2 text-center",children:"All Caught Up!"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md text-[11px] sm:text-xs md:text-sm lg:text-base px-3 sm:px-4 mb-4 sm:mb-6",children:"You don't have any notifications right now. We'll notify you when a student registers or subscribes using your referral!"}),e.jsxs("div",{className:"bg-[var(--app-dark-blue)]/10 rounded-xl px-4 sm:px-6 py-2 sm:py-3 flex items-center gap-2 sm:gap-3 border border-[var(--app-dark-blue)]/20",children:[e.jsx("div",{className:"bg-[var(--app-dark-blue)] rounded-full p-1 sm:p-1.5",children:e.jsx(O,{className:"text-white text-xs sm:text-sm"})}),e.jsx("span",{className:"text-[var(--app-dark-blue)] font-bold text-[11px] sm:text-xs md:text-sm",children:"You're up to date"})]})]})]}),D&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-3 sm:px-4",children:e.jsxs("div",{className:"bg-white rounded-2xl p-4 sm:p-5 md:p-6 max-w-md w-full shadow-2xl",children:[e.jsx("h3",{className:"text-base sm:text-lg md:text-xl font-bold text-gray-800 mb-1.5 sm:mb-2",children:"Delete All Notifications?"}),e.jsx("p",{className:"text-gray-600 mb-4 sm:mb-5 md:mb-6 text-[11px] sm:text-xs md:text-sm",children:"Are you sure you want to delete all notifications? This action cannot be undone."}),e.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>b(!1),disabled:x,className:"flex-1 px-3 sm:px-4 py-2 sm:py-2.5 md:py-3 border-2 border-gray-200 rounded-xl text-gray-700 font-bold hover:bg-gray-50 transition-colors disabled:opacity-50 text-[11px] sm:text-xs md:text-sm",children:"Cancel"}),e.jsx("button",{onClick:B,disabled:x,className:"flex-1 px-3 sm:px-4 py-2 sm:py-2.5 md:py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors disabled:opacity-50 text-[11px] sm:text-xs md:text-sm",children:x?"Deleting...":"Delete All"})]})]})}),e.jsx(G,{})]})};export{Q as default};
