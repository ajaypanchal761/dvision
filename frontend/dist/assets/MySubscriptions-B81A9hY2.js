import{u as D,a as C,r as N,j as e,c as P,R as g,m as y,C as k,I as R}from"./index-BPKQ2keO.js";import{B as I}from"./BottomNav-KrGopomG.js";const F=()=>{const p=D(),{user:t,getCurrentUser:d}=C(),[w,S]=N.useState(!0);N.useEffect(()=>{(async()=>{try{await d()}catch(a){console.error("Error loading subscriptions:",a)}finally{S(!1)}})()},[d]);const c=s=>new Date(s).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),o=s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(s),b=t?.classBasedSubscriptions||[],h=t?.preparationSubscriptions||[],r=[];b.length>0||h.length>0?r.push(...b,...h):(t?.activeSubscriptions&&t.activeSubscriptions.length>0&&r.push(...t.activeSubscriptions.map(s=>({...s,source:"activeSubscriptions"}))),t?.subscription&&t.subscription.status==="active"&&t.subscription.plan&&(r.some(a=>a.plan?._id===t.subscription.plan?._id)||r.push({_id:t.subscription.plan?._id||"legacy",plan:t.subscription.plan,startDate:t.subscription.startDate,endDate:t.subscription.endDate,amount:t.subscription.plan?.price||0,status:"active",source:"legacy"})));const u=r.filter(s=>s.plan?.type==="regular"),j=r.filter(s=>s.plan?.type==="preparation"),v=s=>{if(!s)return!1;const a=Math.ceil((new Date(s).getTime()-Date.now())/(1e3*60*60*24));return a<=7&&a>0},f=s=>s?Math.ceil((new Date(s).getTime()-Date.now())/(1e3*60*60*24)):0;return e.jsxs("div",{className:"min-h-screen w-full bg-white pb-20",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-4 sm:px-6 pt-3 sm:pt-4 pb-4 sm:pb-5",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("button",{onClick:()=>p(g.PROFILE),className:"p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(P,{className:"text-lg sm:text-xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"My Subscriptions"}),e.jsx("p",{className:"text-xs sm:text-sm text-white/90 mt-0.5",children:"View and manage your active subscriptions"})]})]})})}),e.jsx("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-4 sm:py-5",children:w?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px]",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-[var(--app-dark-blue)] mb-3"}),e.jsx("p",{className:"text-[var(--app-black)]/70 text-sm",children:"Loading subscriptions..."})]}):r.length>0?e.jsxs("div",{className:"space-y-5 sm:space-y-6",children:[u.length>0&&e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-[var(--app-black)] mb-3",children:"Class-Based Subscriptions"}),u.map(s=>{const a=s.plan,i=a?.type==="preparation",l=f(s.endDate),n=v(s.endDate);return e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-5 shadow-md border border-gray-200 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-[var(--app-black)]",children:a?.name||"Subscription Plan"}),i&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs font-semibold rounded",children:"Prep"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-[var(--app-black)]/70",children:i?a?.classId?.name||"Preparation Class":`${a?.board} • Classes ${a?.classes?.join(", ")||""}`})]}),e.jsx("span",{className:"px-2.5 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-lg whitespace-nowrap",children:"Active"})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsxs("span",{className:"text-[var(--app-black)]/70 flex items-center gap-1.5",children:[e.jsx(y,{className:"text-[var(--app-dark-blue)] text-sm"}),e.jsx("span",{children:"Expires:"})]}),e.jsx("span",{className:`font-semibold ${n?"text-[var(--app-orange)]":"text-[var(--app-black)]"}`,children:s.endDate?c(s.endDate):"N/A"})]}),l>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-[var(--app-black)]/70",children:"Days Remaining:"}),e.jsxs("span",{className:`font-semibold ${n?"text-[var(--app-orange)]":"text-[var(--app-black)]"}`,children:[l," ",l===1?"day":"days"]})]}),s.startDate&&e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-[var(--app-black)]/70",children:"Start Date:"}),e.jsx("span",{className:"font-semibold text-[var(--app-black)]",children:c(s.startDate)})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-[var(--app-black)]/70",children:"Amount Paid:"}),e.jsx("span",{className:"font-semibold text-[var(--app-black)]",children:o(s.amount||a?.price||0)})]}),a?.duration&&e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-[var(--app-black)]/70",children:"Duration:"}),e.jsx("span",{className:"font-semibold text-[var(--app-black)] capitalize",children:a.duration})]})]}),a?.features&&a.features.length>0&&e.jsxs("div",{className:"pt-3 border-t border-gray-200",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-[var(--app-black)] mb-1.5",children:"Features:"}),e.jsxs("div",{className:"space-y-1",children:[a.features.slice(0,5).map((x,m)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs sm:text-sm",children:[e.jsx(k,{className:"text-[var(--app-dark-blue)] text-sm mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-[var(--app-black)]/70",children:x})]},m)),a.features.length>5&&e.jsxs("p",{className:"text-xs text-[var(--app-black)]/50 pl-5",children:["+",a.features.length-5," more features"]})]})]}),n&&e.jsx("div",{className:"mt-3 p-2.5 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsx("p",{className:"text-xs sm:text-sm text-amber-700 font-medium",children:"⚠️ Your subscription is expiring soon. Renew to continue access."})})]},s._id)})]}),j.length>0&&e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-[var(--app-black)] mb-3",children:"Preparation Class Subscriptions"}),j.map(s=>{const a=s.plan,i=a?.type==="preparation",l=f(s.endDate),n=v(s.endDate);return e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-5 shadow-md border border-gray-200 hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-[var(--app-black)]",children:a?.name||"Subscription Plan"}),i&&e.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs font-semibold rounded",children:"Prep"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-[var(--app-black)]/70",children:i?a?.classId?.name||"Preparation Class":`${a?.board} • Classes ${a?.classes?.join(", ")||""}`})]}),e.jsx("span",{className:"px-2.5 py-1 bg-green-100 text-green-700 text-xs font-semibold rounded-lg whitespace-nowrap",children:"Active"})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsxs("span",{className:"text-[var(--app-black)]/70 flex items-center gap-1.5",children:[e.jsx(y,{className:"text-[var(--app-dark-blue)] text-sm"}),e.jsx("span",{children:"Expires:"})]}),e.jsx("span",{className:`font-semibold ${n?"text-[var(--app-orange)]":"text-[var(--app-black)]"}`,children:s.endDate?c(s.endDate):"N/A"})]}),l>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-[var(--app-black)]/70",children:"Days Remaining:"}),e.jsxs("span",{className:`font-semibold ${n?"text-[var(--app-orange)]":"text-[var(--app-black)]"}`,children:[l," ",l===1?"day":"days"]})]}),s.startDate&&e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-[var(--app-black)]/70",children:"Start Date:"}),e.jsx("span",{className:"font-semibold text-[var(--app-black)]",children:c(s.startDate)})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-[var(--app-black)]/70",children:"Amount Paid:"}),e.jsx("span",{className:"font-semibold text-[var(--app-black)]",children:o(s.amount||a?.price||0)})]}),a?.duration&&e.jsxs("div",{className:"flex items-center justify-between text-xs sm:text-sm",children:[e.jsx("span",{className:"text-[var(--app-black)]/70",children:"Duration:"}),e.jsx("span",{className:"font-semibold text-[var(--app-black)] capitalize",children:a.duration})]})]}),a?.features&&a.features.length>0&&e.jsxs("div",{className:"pt-3 border-t border-gray-200",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-[var(--app-black)] mb-1.5",children:"Features:"}),e.jsxs("div",{className:"space-y-1",children:[a.features.slice(0,5).map((x,m)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs sm:text-sm",children:[e.jsx(k,{className:"text-[var(--app-dark-blue)] text-sm mt-0.5 flex-shrink-0"}),e.jsx("span",{className:"text-[var(--app-black)]/70",children:x})]},m)),a.features.length>5&&e.jsxs("p",{className:"text-xs text-[var(--app-black)]/50 pl-5",children:["+",a.features.length-5," more features"]})]})]}),n&&e.jsx("div",{className:"mt-3 p-2.5 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsx("p",{className:"text-xs sm:text-sm text-amber-700 font-medium",children:"⚠️ Your subscription is expiring soon. Renew to continue access."})})]},s._id)})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] bg-white rounded-xl sm:rounded-2xl p-6 sm:p-8 shadow-lg border border-gray-200",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-[var(--app-dark-blue)]/10 rounded-full flex items-center justify-center mb-4",children:e.jsx(R,{className:"text-[var(--app-dark-blue)] text-2xl sm:text-3xl"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-[var(--app-black)] mb-2",children:"No Active Subscriptions"}),e.jsx("p",{className:"text-[var(--app-black)]/70 text-center max-w-md mb-5 text-xs sm:text-sm",children:"You don't have any active subscriptions. Browse our subscription plans and start learning!"}),e.jsx("button",{onClick:()=>p(g.SUBSCRIPTION_PLANS),className:"bg-gradient-to-r from-[var(--app-dark-blue)] to-[var(--app-teal)] text-white font-semibold px-5 py-2.5 rounded-xl hover:shadow-lg transition-all text-sm",children:"View Subscription Plans"})]})}),e.jsx(I,{})]})};export{F as default};
