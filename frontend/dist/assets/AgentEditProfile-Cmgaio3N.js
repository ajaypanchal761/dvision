import{u as O,r as o,j as e,c as R,ay as g,d as k,f as C,Y as M,e as T}from"./index-BPKQ2keO.js";import{a as f}from"./api-CVReUq8b.js";import{B as _}from"./BottomNav-BGePCkyK.js";const z=()=>{const c=O(),[m,p]=o.useState({name:"",email:""}),[b,h]=o.useState({name:"Agent",phone:"",email:"",profileImage:null}),[y,n]=o.useState(!1),[v,E]=o.useState(null),[N,x]=o.useState(null),[j,u]=o.useState(""),[w,r]=o.useState(""),[L,I]=o.useState(!0);o.useEffect(()=>{F()},[]);const F=async()=>{try{I(!0);const s=await f.getMe();if(s.success&&s.data&&s.data.agent){const a=s.data.agent;h({name:a.name||"Agent",phone:a.phone||"",email:a.email||"",profileImage:a.profileImage||null}),p({name:a.name||"",email:a.email||""}),a.profileImage&&x(a.profileImage)}}catch(s){console.error("Error fetching agent data:",s);const a=localStorage.getItem("agent_data");if(a)try{const t=JSON.parse(a);h({name:t.name||"Agent",phone:t.phone||"",email:t.email||"",profileImage:t.profileImage||null}),p({name:t.name||"",email:t.email||""}),t.profileImage&&x(t.profileImage)}catch(t){console.error("Error parsing stored data:",t)}}finally{I(!1)}},S=s=>{p({...m,[s.target.name]:s.target.value})},A=s=>{const a=s.target.files[0];if(a){if(!a.type.startsWith("image/")){r("Please select an image file"),setTimeout(()=>r(""),3e3);return}if(a.size>5*1024*1024){r("Image size should be less than 5MB"),setTimeout(()=>r(""),3e3);return}E(a),r("");const t=new FileReader;t.onloadend=()=>{x(t.result)},t.readAsDataURL(a)}},D=async s=>{s.preventDefault(),n(!0),r(""),u("");try{const a={name:m.name,email:m.email};if(v){const t=new FileReader;t.onloadend=async()=>{const d=t.result;a.profileImageBase64=d;try{const l=await f.updateMe(a);if(l.success){n(!1),u("Profile updated successfully!");const P=localStorage.getItem("agent_data");if(P)try{const i=JSON.parse(P);i.name=m.name,i.email=m.email,i.profileImage=d,localStorage.setItem("agent_data",JSON.stringify(i))}catch(i){console.error("Error updating local storage:",i)}setTimeout(()=>{c(g.AGENT_PROFILE)},1500)}else n(!1),r(l.message||"Failed to update profile. Please try again.")}catch(l){n(!1),r(l.message||"Failed to update profile. Please try again.")}},t.readAsDataURL(v)}else{const t=await f.updateMe(a);if(t.success){n(!1),u("Profile updated successfully!");const d=localStorage.getItem("agent_data");if(d)try{const l=JSON.parse(d);l.name=m.name,l.email=m.email,localStorage.setItem("agent_data",JSON.stringify(l))}catch(l){console.error("Error updating local storage:",l)}setTimeout(()=>{c(g.AGENT_PROFILE)},1500)}else n(!1),r(t.message||"Failed to update profile. Please try again.")}}catch(a){n(!1),r(a.message||"Failed to update profile. Please try again.")}};return e.jsxs("div",{className:"min-h-screen w-full bg-white pb-20 sm:pb-24",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-3 sm:px-4 md:px-6 pt-3 sm:pt-4 md:pt-5 pb-4 sm:pb-5 md:pb-6",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>c(g.AGENT_PROFILE),className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(R,{className:"text-lg sm:text-xl md:text-2xl"})}),e.jsx("h1",{className:"text-sm sm:text-base md:text-lg lg:text-xl font-bold",children:"Edit Profile"})]})})}),e.jsx("div",{className:"px-3 sm:px-4 md:px-6 mt-3 sm:mt-4 md:mt-5",children:e.jsxs("form",{onSubmit:D,className:"space-y-4 sm:space-y-5 max-w-md mx-auto",children:[w&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-xs sm:text-sm font-medium",children:w}),e.jsxs("div",{className:"flex flex-col items-center mb-3 sm:mb-4",children:[e.jsxs("div",{className:"relative",children:[N?e.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28 rounded-full overflow-hidden border-2 sm:border-4 border-[var(--app-dark-blue)]",children:e.jsx("img",{src:N,alt:"Profile",className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28 rounded-full bg-[var(--app-dark-blue)] flex items-center justify-center border-2 sm:border-4 border-[var(--app-dark-blue)]",children:e.jsx(k,{className:"text-white text-2xl sm:text-3xl md:text-4xl"})}),e.jsxs("label",{htmlFor:"profileImage",className:"absolute -bottom-1 sm:-bottom-2 -right-1 sm:-right-2 w-8 h-8 sm:w-10 sm:h-10 bg-[var(--app-dark-blue)] rounded-full flex items-center justify-center cursor-pointer hover:bg-[var(--app-dark-blue)]/90 transition-colors shadow-lg border-2 border-white",children:[e.jsx(C,{className:"text-white text-sm sm:text-lg"}),e.jsx("input",{type:"file",id:"profileImage",accept:"image/*",onChange:A,className:"hidden"})]})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mt-2 text-center",children:"Click camera icon to change photo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-bold text-gray-700 mb-1.5 sm:mb-2",children:"Name"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 sm:left-4 top-1/2 transform -translate-y-1/2",children:e.jsx(k,{className:"text-[var(--app-dark-blue)] text-base sm:text-lg"})}),e.jsx("input",{type:"text",name:"name",value:m.name||b.name,onChange:S,className:"w-full pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3 md:py-3.5 rounded-xl border-2 border-gray-200 bg-white focus:outline-none focus:border-[var(--app-dark-blue)] focus:ring-2 focus:ring-[var(--app-dark-blue)]/20 transition-all text-gray-800 font-medium text-xs sm:text-sm md:text-base",placeholder:"Enter your name",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-bold text-gray-700 mb-1.5 sm:mb-2",children:"Phone Number"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 sm:left-4 top-1/2 transform -translate-y-1/2",children:e.jsx(M,{className:"text-gray-400 text-base sm:text-lg"})}),e.jsx("input",{type:"tel",value:b.phone,readOnly:!0,className:"w-full pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3 md:py-3.5 rounded-xl border-2 border-gray-200 bg-gray-100 focus:outline-none text-gray-600 font-medium cursor-not-allowed text-xs sm:text-sm md:text-base",placeholder:"Phone number"})]}),e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 mt-1",children:"Phone number cannot be changed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-bold text-gray-700 mb-1.5 sm:mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 sm:left-4 top-1/2 transform -translate-y-1/2",children:e.jsx(T,{className:"text-[var(--app-dark-blue)] text-base sm:text-lg"})}),e.jsx("input",{type:"email",name:"email",value:m.email,onChange:S,className:"w-full pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3 md:py-3.5 rounded-xl border-2 border-gray-200 bg-white focus:outline-none focus:border-[var(--app-dark-blue)] focus:ring-2 focus:ring-[var(--app-dark-blue)]/20 transition-all text-gray-800 font-medium text-xs sm:text-sm md:text-base",placeholder:"Enter your email",required:!0})]})]}),e.jsx("button",{type:"submit",disabled:y,className:"w-full bg-[var(--app-dark-blue)] text-white font-bold py-3 sm:py-3.5 md:py-4 rounded-xl hover:bg-[var(--app-dark-blue)]/90 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed mt-4 sm:mt-6 text-xs sm:text-sm md:text-base",children:y?"Saving...":"Save Changes"}),j&&e.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-3 sm:px-4 py-2 sm:py-3 rounded-lg text-xs sm:text-sm font-medium",children:j})]})}),e.jsx(_,{})]})};export{z as default};
