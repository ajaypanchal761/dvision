import{u as U,r as s,j as e,d as D,ay as l,g as B,aB as W,a5 as _,m as P,ah as O,t as G,az as g}from"./index-BPKQ2keO.js";import{B as M}from"./BottomNav-BGePCkyK.js";import{n as z,a as d}from"./api-CVReUq8b.js";const q=()=>{const r=U(),[n,b]=s.useState({name:"Agent",profileImage:null}),[j,o]=s.useState(!0),[m,N]=s.useState({totalReferrals:0,successfulSubscriptions:0,pendingCommissions:0}),[x,y]=s.useState(""),[p,w]=s.useState(""),[u,v]=s.useState([]),[c,S]=s.useState([]),[k,h]=s.useState(!1),[i,C]=s.useState(0);s.useEffect(()=>{I(),A(),R(),f();const t=setInterval(()=>{f()},3e4);return()=>clearInterval(t)},[]);const f=async()=>{try{const t=await z.getUnreadCount();t.success&&t.data?.unreadCount!==void 0&&C(t.data.unreadCount)}catch(t){console.error("Error fetching unread count:",t)}},I=async()=>{try{o(!0);const t=await d.getMe();if(t.success&&t.data&&t.data.agent){const a=t.data.agent;b({name:a.name||"Agent",profileImage:a.profileImage||null}),localStorage.setItem("agent_data",JSON.stringify(a))}}catch(t){console.error("Error fetching agent data:",t)}finally{o(!1)}},A=async()=>{try{const t=await d.getStatistics();t.success&&t.data&&(N(t.data.statistics||{totalReferrals:0,successfulSubscriptions:0,pendingCommissions:0}),v(t.data.recentReferralStudents||[]),S(t.data.monthWiseBreakdown||[]))}catch(t){console.error("Error fetching statistics:",t)}},R=async()=>{try{const t=await d.getReferralLink();t.success&&t.data&&(y(t.data.referralLink||""),w(t.data.whatsappUrl||""))}catch(t){console.error("Error fetching referral link:",t)}},T=()=>{x&&(navigator.clipboard.writeText(x),h(!0),setTimeout(()=>h(!1),2e3))},L=()=>{p&&window.open(p,"_blank")},E=t=>t?new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",F=t=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:0}).format(t);return e.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20 sm:pb-24",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-3 sm:px-4 md:px-6 pt-3 sm:pt-4 md:pt-5 pb-4 sm:pb-5 md:pb-6",children:e.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 md:gap-4",children:[e.jsx("button",{onClick:()=>r(l.AGENT_PROFILE),className:"hover:opacity-80",children:n.profileImage?e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-full overflow-hidden border-2 border-white cursor-pointer hover:border-white/80 shadow-lg",children:e.jsx("img",{src:n.profileImage,alt:"Profile",className:"w-full h-full object-cover"})}):e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 rounded-full bg-white/20 flex items-center justify-center cursor-pointer hover:bg-white/30 shadow-lg",children:e.jsx(D,{className:"text-white text-base sm:text-lg md:text-xl"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-white/90 mb-0.5 truncate",children:"Welcome back!"}),e.jsx("h1",{className:"text-sm sm:text-base md:text-lg lg:text-xl font-bold truncate",children:j?"Loading...":n.name})]})]}),e.jsxs("button",{onClick:()=>r(l.AGENT_NOTIFICATIONS),className:"relative p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors flex-shrink-0",title:"Notifications",children:[e.jsx(B,{className:"text-lg sm:text-xl md:text-2xl"}),i>0&&e.jsx("span",{className:"absolute top-0 right-0 w-3 h-3 sm:w-4 sm:h-4 bg-red-500 rounded-full flex items-center justify-center text-[8px] sm:text-xs font-bold",children:i>9?"9+":i})]})]})})}),e.jsxs("div",{className:"px-3 sm:px-4 md:px-6 mt-2 sm:mt-3 md:mt-4 space-y-3 sm:space-y-4 md:space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mt-2 sm:mt-3",children:[e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl p-2 sm:p-5 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[e.jsx("p",{className:"text-[10px] sm:text-sm text-gray-600 font-medium",children:"Total Referrals"}),e.jsx("div",{className:"w-6 h-6 sm:w-12 sm:h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(W,{className:"text-blue-600 text-xs sm:text-xl"})})]}),e.jsx("p",{className:"text-lg sm:text-3xl font-bold text-[var(--app-dark-blue)]",children:m.totalReferrals})]}),e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl p-2 sm:p-5 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[e.jsx("p",{className:"text-[10px] sm:text-sm text-gray-600 font-medium",children:"Successful Subscriptions"}),e.jsx("div",{className:"w-6 h-6 sm:w-12 sm:h-12 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(_,{className:"text-green-600 text-xs sm:text-xl"})})]}),e.jsx("p",{className:"text-lg sm:text-3xl font-bold text-green-600",children:m.successfulSubscriptions})]}),e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl p-2 sm:p-5 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[e.jsx("p",{className:"text-[10px] sm:text-sm text-gray-600 font-medium",children:"Pending Commissions"}),e.jsx("div",{className:"w-6 h-6 sm:w-12 sm:h-12 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(P,{className:"text-orange-600 text-xs sm:text-xl"})})]}),e.jsx("p",{className:"text-lg sm:text-3xl font-bold text-orange-600",children:m.pendingCommissions})]})]}),e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-5 shadow-lg",children:[e.jsx("h2",{className:"text-sm sm:text-base md:text-lg font-bold text-[var(--app-black)] mb-2 sm:mb-3",children:"Your Referral Link"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex-1 bg-gray-50 rounded-lg sm:rounded-xl p-2 sm:p-3 border border-gray-200",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-600 mb-0.5 sm:mb-1",children:"Referral Link"}),e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-[var(--app-black)] break-all font-mono",children:x||"Loading..."})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[e.jsxs("button",{onClick:T,className:"flex items-center justify-center gap-1.5 sm:gap-2 px-2.5 sm:px-3 md:px-4 py-1.5 sm:py-2 md:py-2.5 bg-[var(--app-dark-blue)] text-white rounded-lg sm:rounded-xl hover:opacity-90 transition-all text-[10px] sm:text-xs md:text-sm font-medium",children:[e.jsx(O,{className:"text-xs sm:text-sm md:text-base"}),k?"Copied!":"Copy"]}),e.jsxs("button",{onClick:L,className:"flex items-center justify-center gap-1.5 sm:gap-2 px-2.5 sm:px-3 md:px-4 py-1.5 sm:py-2 md:py-2.5 bg-green-500 text-white rounded-lg sm:rounded-xl hover:opacity-90 transition-all text-[10px] sm:text-xs md:text-sm font-medium",children:[e.jsx(G,{className:"text-xs sm:text-sm md:text-base"}),"WhatsApp"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-5 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[e.jsx("h2",{className:"text-sm sm:text-base md:text-lg font-bold text-[var(--app-black)]",children:"Recent Referrals"}),e.jsxs("button",{onClick:()=>r(l.AGENT_STATISTICS),className:"text-[10px] sm:text-xs md:text-sm text-[var(--app-dark-blue)] hover:underline flex items-center gap-1 font-semibold",children:["View All",e.jsx(g,{className:"text-[10px] sm:text-xs"})]})]}),u.length>0?e.jsx("div",{className:"space-y-1.5 sm:space-y-2",children:u.map(t=>e.jsx("div",{className:"flex items-center justify-between p-2 sm:p-2.5 md:p-3 bg-gray-50 rounded-lg sm:rounded-xl",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-[11px] sm:text-xs md:text-sm font-medium text-[var(--app-black)]",children:t.name||"Student"}),e.jsx("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-gray-600",children:E(t.referredAt)})]})},t._id))}):e.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-gray-500 text-center py-3 sm:py-4",children:"No referrals yet. Share your referral link to get started!"})]}),c.length>0&&e.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-5 shadow-lg",children:[e.jsx("h2",{className:"text-sm sm:text-base md:text-lg font-bold text-[var(--app-black)] mb-2 sm:mb-3",children:"Monthly Performance"}),e.jsx("div",{className:"space-y-1.5 sm:space-y-2",children:c.slice(0,6).map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-2.5 md:p-3 bg-gray-50 rounded-lg sm:rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] sm:text-xs md:text-sm font-medium text-[var(--app-black)]",children:new Date(t.month+"-01").toLocaleDateString("en-US",{month:"long",year:"numeric"})}),e.jsxs("p",{className:"text-[9px] sm:text-[10px] md:text-xs text-gray-600",children:[t.count," ",t.count===1?"referral":"referrals"]})]}),e.jsx("p",{className:"text-[11px] sm:text-xs md:text-sm font-bold text-[var(--app-dark-blue)]",children:F(t.totalAmount)})]},a))}),c.length>6&&e.jsxs("button",{onClick:()=>r(l.AGENT_STATISTICS),className:"w-full mt-2 sm:mt-3 text-[10px] sm:text-xs md:text-sm text-[var(--app-dark-blue)] hover:underline flex items-center justify-center gap-1 font-semibold",children:["View All Months",e.jsx(g,{className:"text-[10px] sm:text-xs"})]})]})]}),e.jsx(M,{})]})};export{q as default};
