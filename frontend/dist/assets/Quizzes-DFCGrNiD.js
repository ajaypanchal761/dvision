import{u as X,a as Z,r,s as V,j as e,c as ee,k as F,a5 as $,a6 as se,m as j,S as te,i as E,a7 as ae,a0 as re,a1 as le}from"./index-BPKQ2keO.js";import{B as de}from"./BottomNav-KrGopomG.js";const xe=()=>{const p=X(),{user:ie,hasActiveSubscription:B}=Z(),[l,w]=r.useState([]),[b,T]=r.useState(!0),[h,U]=r.useState({}),[u,O]=r.useState(""),[m,g]=r.useState("all"),[f,N]=r.useState({total:0,available:0,submitted:0,expired:0}),[_,ne]=r.useState({total:0,available:0,submitted:0,expired:0}),[i,x]=r.useState(1),[k]=r.useState(10),[v,Y]=r.useState(1),[A,q]=r.useState(0),S=r.useRef(!1);r.useEffect(()=>{P()},[i,m]),r.useEffect(()=>{x(1);const s=setTimeout(()=>{P()},500);return()=>clearTimeout(s)},[u]),r.useEffect(()=>{l.length>0&&D()},[l]),r.useEffect(()=>{const s=()=>{l.length>0&&D()};return window.addEventListener("focus",s),()=>window.removeEventListener("focus",s)},[l]);const P=async()=>{try{T(!0);const s={page:i,limit:k,status:m!=="all"?m:void 0,search:u},t=await V.getQuizzes(s);t.success&&t.data?.quizzes?(w(t.data.quizzes),Y(t.pages||1),q(t.total||0)):w([])}catch(s){console.error("Error fetching quizzes:",s),u||w([])}finally{T(!1)}},D=async()=>{const s={};for(const t of l)try{const a=await V.getSubmissionStatus(t._id);a.success&&(s[t._id]=a.data.hasSubmitted)}catch(a){console.error(`Error checking submission status for quiz ${t._id}:`,a),s[t._id]=!1}U(s)},G=s=>{if(!s)return null;const t=new Date(s),a=t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),c=t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return`${a} ${c}`},y=s=>{if(!s)return!1;const t=new Date,a=new Date(s),c=new Date(a.getTime()+6e4);return t>=c},C=l,n=_.total>0?_:{total:l.length,available:l.filter(s=>{const t=h[s._id]||!1,a=y(s.deadline)&&!t;return!t&&!a}).length,submitted:l.filter(s=>h[s._id]).length,expired:l.filter(s=>{const t=h[s._id]||!1;return y(s.deadline)&&!t}).length};return r.useEffect(()=>{if(!b&&l.length>0&&!S.current){S.current=!0;const s=20,t=n.total,a=n.available,c=n.submitted,d=n.expired,o=(L,Q)=>{const H=Date.now(),M=0,R=()=>{const J=Date.now()-H,I=Math.min(J/s,1),K=1-Math.pow(1-I,3),W=Math.floor(M+(L-M)*K);N(z=>({...z,[Q]:W})),I<1?requestAnimationFrame(R):N(z=>({...z,[Q]:L}))};requestAnimationFrame(R)};requestAnimationFrame(()=>{o(t,"total"),o(a,"available"),o(c,"submitted"),o(d,"expired")})}else!b&&l.length===0&&(N({total:0,available:0,submitted:0,expired:0}),S.current=!1)},[b,n.total,n.available,n.submitted,n.expired]),e.jsxs("div",{className:"min-h-screen bg-white pb-20",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative animate-fade-in",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-3 sm:px-4 md:px-6 pt-3 sm:pt-4 md:pt-6 pb-4 sm:pb-6 md:pb-8",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>p(-1),className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors hover:scale-110",children:e.jsx(ee,{className:"text-lg sm:text-xl md:text-2xl"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold animate-slide-in-left",children:"Quizzes"}),e.jsx("p",{className:"text-xs sm:text-sm text-white/90 mt-0.5 sm:mt-1",children:"Test your knowledge"})]})]})})}),e.jsx("div",{className:"px-3 sm:px-4 md:px-6 pt-4 sm:pt-5 md:pt-6 mb-3 sm:mb-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3",children:[e.jsxs("div",{className:"group bg-gradient-to-br from-white to-indigo-50 rounded-lg sm:rounded-xl shadow-lg hover:shadow-xl p-3 sm:p-4 border border-gray-200 hover:border-indigo-300 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 font-medium",children:"Total"}),e.jsx(F,{className:"text-indigo-600 text-base sm:text-lg group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-extrabold text-indigo-600",children:f.total})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-white to-blue-50 rounded-lg sm:rounded-xl shadow-lg hover:shadow-xl p-3 sm:p-4 border border-gray-200 hover:border-blue-300 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 font-medium",children:"Available"}),e.jsx($,{className:"text-blue-600 text-base sm:text-lg group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-extrabold text-blue-600",children:f.available})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-white to-blue-50 rounded-lg sm:rounded-xl shadow-lg hover:shadow-xl p-3 sm:p-4 border border-gray-200 hover:border-blue-300 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 font-medium",children:"Submitted"}),e.jsx(se,{className:"text-blue-600 text-base sm:text-lg group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-extrabold text-blue-600",children:f.submitted})]}),e.jsxs("div",{className:"group bg-gradient-to-br from-white to-gray-50 rounded-lg sm:rounded-xl shadow-lg hover:shadow-xl p-3 sm:p-4 border border-gray-200 hover:border-gray-300 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-gray-500 font-medium",children:"Expired"}),e.jsx(j,{className:"text-gray-600 text-base sm:text-lg group-hover:scale-110 transition-transform"})]}),e.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-extrabold text-gray-600",children:f.expired})]})]})}),e.jsx("div",{className:"px-3 sm:px-4 md:px-6 mb-3 sm:mb-4 animate-slide-in-up",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 overflow-x-auto pb-2",children:[e.jsx("button",{onClick:()=>{g("all"),x(1)},className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl font-semibold text-xs sm:text-sm whitespace-nowrap transition-all duration-300 hover:scale-105 ${m==="all"?"bg-gradient-to-r from-[var(--app-dark-blue)] to-blue-700 text-white shadow-lg":"bg-white text-gray-700 border-2 border-gray-200 hover:border-[var(--app-dark-blue)]/30"}`,children:"All"}),e.jsx("button",{onClick:()=>{g("available"),x(1)},className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl font-semibold text-xs sm:text-sm whitespace-nowrap transition-all duration-300 ${m==="available"?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg":"bg-white text-gray-700 border-2 border-gray-200 hover:border-blue-300"}`,children:"Available"}),e.jsx("button",{onClick:()=>{g("submitted"),x(1)},className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl font-semibold text-xs sm:text-sm whitespace-nowrap transition-all duration-300 ${m==="submitted"?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg":"bg-white text-gray-700 border-2 border-gray-200 hover:border-blue-300"}`,children:"Submitted"}),e.jsx("button",{onClick:()=>{g("expired"),x(1)},className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg sm:rounded-xl font-semibold text-xs sm:text-sm whitespace-nowrap transition-all duration-300 ${m==="expired"?"bg-gradient-to-r from-gray-500 to-gray-600 text-white shadow-lg":"bg-white text-gray-700 border-2 border-gray-200 hover:border-gray-300"}`,children:"Expired"})]})}),e.jsx("div",{className:"px-3 sm:px-4 md:px-6 mb-3 sm:mb-4 animate-fade-in",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 sm:pl-4 flex items-center pointer-events-none",children:e.jsx(te,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Search quizzes by name, subject, board, or class...",value:u,onChange:s=>O(s.target.value),className:"w-full pl-9 sm:pl-10 md:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3 text-xs sm:text-sm border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-[var(--app-dark-blue)] focus:border-[var(--app-dark-blue)] outline-none transition-all shadow-sm hover:shadow-md"})]})}),e.jsxs("main",{className:"px-3 sm:px-4 md:px-6 pb-20 sm:pb-24",children:[b?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[40vh] py-8 sm:py-10 md:py-12",children:[e.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 md:w-16 md:h-16 border-4 border-[var(--app-dark-blue)] border-t-transparent rounded-full animate-spin mb-3 sm:mb-4"}),e.jsx("p",{className:"text-gray-600 text-sm sm:text-base font-medium",children:"Loading quizzes..."})]}):B?C.length===0?e.jsxs("div",{className:"bg-gray-50 rounded-xl p-8 sm:p-10 md:p-12 border-2 border-dashed border-gray-300 text-center",children:[e.jsx(E,{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto text-gray-400 mb-3 sm:mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium text-xs sm:text-sm mb-1",children:u?"No quizzes found matching your search.":"No quizzes available."}),e.jsx("p",{className:"text-gray-400 text-[10px] sm:text-xs",children:u?"Try adjusting your search criteria.":"Check back later for new quizzes."})]}):e.jsx("div",{className:"space-y-4 sm:space-y-5 md:space-y-6",children:C.map((s,t)=>{const a=h[s._id]||!1,c=y(s.deadline),d=y(s.deadline)&&!a;return e.jsx("div",{onClick:()=>!a&&!d&&p(`/quiz/${s._id}`),className:`group relative bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 border border-[var(--app-dark-blue)]/60 hover:border-[var(--app-dark-blue)] transition-all duration-300 transform hover:-translate-y-0.5 shadow-sm hover:shadow-md shadow-gray-200/50 ${t%2===0?"animate-slide-in-left":"animate-slide-in-right"} ${a?"cursor-default bg-blue-50/20":d?"cursor-default bg-gray-50/20":"cursor-pointer bg-white"}`,style:{animationDelay:`${t*.15}s`},children:e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 sm:gap-3",children:e.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-bold text-gray-900 mb-1.5 sm:mb-2 group-hover:text-[var(--app-dark-blue)] transition-colors leading-tight",children:s.name}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx(F,{className:"w-3 h-3 text-gray-600 flex-shrink-0"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-gray-700",children:s.subjectId?.name||"N/A"})]}),s.classId?e.jsx("div",{className:"flex items-center gap-1 px-2 py-1 bg-purple-50 border border-purple-200 rounded-lg",children:e.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-purple-700",children:s.classId.name||"Prep Class"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 border border-gray-200 rounded-lg",children:e.jsxs("span",{className:"text-[10px] sm:text-xs font-medium text-gray-700",children:["Class ",s.classNumber]})}),e.jsx("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 border border-gray-200 rounded-lg",children:e.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-gray-700",children:s.board})})]}),s.questions&&e.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx(F,{className:"w-3 h-3 text-gray-600 flex-shrink-0"}),e.jsxs("span",{className:"text-[10px] sm:text-xs font-medium text-gray-700",children:[s.questions.length," Q"]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[s.deadline&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx(j,{className:`w-3 h-3 ${d?"text-red-600":"text-gray-600"}`}),e.jsxs("span",{className:`text-[10px] sm:text-xs font-medium ${d?"text-red-700":"text-gray-700"}`,children:[G(s.deadline),d&&" (Expired)"]})]}),e.jsx("div",{children:a?e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx($,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-blue-700",children:"Submitted"})]}):d?e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-gray-50 border border-gray-200 rounded-lg",children:[e.jsx(j,{className:"w-3 h-3 text-gray-600"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-gray-700",children:"Expired"})]}):e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx($,{className:"w-3 h-3 text-blue-600"}),e.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-blue-700",children:"Available"})]})})]}),(a||d)&&s._id&&e.jsx("div",{className:"mt-2 sm:mt-3",children:c?e.jsxs("button",{onClick:o=>{o.stopPropagation(),s._id&&p(`/quiz-results/${s._id}`)},className:"w-full sm:w-auto bg-gradient-to-r from-[var(--app-dark-blue)] to-blue-700 hover:from-blue-700 hover:to-[var(--app-dark-blue)] text-white font-bold py-2.5 sm:py-3 px-4 rounded-lg sm:rounded-xl transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl text-xs sm:text-sm h-10 sm:h-11",children:[e.jsx(ae,{className:"text-sm sm:text-base"}),e.jsx("span",{children:"View Results"})]}):e.jsxs("div",{className:"w-full bg-amber-50 border-2 border-amber-400 rounded-lg sm:rounded-xl px-4 flex items-center gap-2 sm:gap-3 shadow-md h-10 sm:h-11",children:[e.jsx(j,{className:"text-amber-600 text-base sm:text-lg flex-shrink-0"}),e.jsx("p",{className:"text-amber-900 font-bold text-sm sm:text-base",children:"Results Pending"})]})}),!a&&!d&&e.jsx("div",{className:"mt-2 sm:mt-3",children:e.jsxs("button",{onClick:o=>{o.stopPropagation(),s._id&&p(`/quiz/${s._id}`)},className:"w-full sm:w-auto bg-gradient-to-r from-[var(--app-dark-blue)] to-blue-700 hover:from-blue-700 hover:to-[var(--app-dark-blue)] text-white font-bold py-2.5 sm:py-3 px-4 rounded-lg sm:rounded-xl border border-[var(--app-dark-blue)]/60 hover:border-[var(--app-dark-blue)] transition-all flex items-center justify-center gap-2 shadow-lg hover:shadow-xl text-xs sm:text-sm h-10 sm:h-11",children:[e.jsx(E,{className:"text-sm sm:text-base"}),e.jsx("span",{children:"Take Test"})]})})]})})},s._id)})}):e.jsxs("div",{className:"bg-gray-50 rounded-xl p-8 sm:p-10 md:p-12 border-2 border-dashed border-gray-300 text-center",children:[e.jsx(E,{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto text-gray-400 mb-3 sm:mb-4"}),e.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-gray-800 mb-2 text-center",children:"No Subscription"}),e.jsx("p",{className:"text-gray-500 font-medium text-xs sm:text-sm mb-4",children:"You need an active subscription to access quizzes. Please subscribe to a plan to continue learning."}),e.jsx("button",{onClick:()=>p("/subscription-plans"),className:"bg-[var(--app-dark-blue)] hover:bg-blue-700 text-white font-bold py-2.5 sm:py-3 px-6 sm:px-8 rounded-lg sm:rounded-xl transition-all duration-200 shadow-lg hover:shadow-xl text-xs sm:text-sm md:text-base",children:"View Subscription Plans"})]}),!b&&C.length>0&&e.jsx("div",{className:"mt-4 sm:mt-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 bg-white p-4 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{className:"text-sm text-gray-500 font-medium",children:["Showing ",e.jsx("span",{className:"font-bold text-gray-900",children:(i-1)*k+1})," to ",e.jsx("span",{className:"font-bold text-gray-900",children:Math.min(i*k,A)})," of ",e.jsx("span",{className:"font-bold text-gray-900",children:A})," results"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>x(s=>Math.max(1,s-1)),disabled:i===1,className:`p-2 rounded-lg border flex items-center gap-1 transition-all ${i===1?"border-gray-200 text-gray-300 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-[var(--app-dark-blue)] hover:text-white hover:border-[var(--app-dark-blue)]"}`,children:[e.jsx(re,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline font-medium",children:"Previous"})]}),e.jsx("div",{className:"flex items-center gap-1 px-2",children:e.jsxs("span",{className:"text-sm font-medium text-gray-700 bg-gray-50 px-3 py-1 rounded-md border border-gray-200",children:["Page ",i," of ",v]})}),e.jsxs("button",{onClick:()=>x(s=>Math.min(v,s+1)),disabled:i===v,className:`p-2 rounded-lg border flex items-center gap-1 transition-all ${i===v?"border-gray-200 text-gray-300 cursor-not-allowed":"border-gray-300 text-gray-700 hover:bg-[var(--app-dark-blue)] hover:text-white hover:border-[var(--app-dark-blue)]"}`,children:[e.jsx("span",{className:"hidden sm:inline font-medium",children:"Next"}),e.jsx(le,{className:"w-5 h-5"})]})]})]})})]}),e.jsx(de,{})]})};export{xe as default};
