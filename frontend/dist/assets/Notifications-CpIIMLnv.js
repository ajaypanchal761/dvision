import{u as B,r as n,j as e,c as I,R as L,y as T,z,A as k,B as S,g as q,C as H,n as h}from"./index-BPKQ2keO.js";import{B as O}from"./BottomNav-KrGopomG.js";const J=()=>{const D=B(),[l,f]=n.useState([]),[a,r]=n.useState([]),[p,y]=n.useState(!0),[c,x]=n.useState(!1),[F,g]=n.useState(!1),[v,o]=n.useState(""),[d,u]=n.useState(!1),w=async()=>{try{y(!0),o("");const t=await h.getMyNotifications();if(t.success&&t.data?.notifications){if(f(t.data.notifications),t.data.notifications.length>0){const s=t.data.notifications.filter(i=>!i.isRead).map(i=>i._id);s.length>0&&await h.markAsRead(s)}}else o("Failed to load notifications")}catch(t){const s=t?.message||t?.toString()||"Failed to load notifications";o(typeof s=="string"?s:"Failed to load notifications")}finally{y(!1)}};n.useEffect(()=>{w()},[]);const C=()=>{a.length===l.length?r([]):r(l.map(t=>t._id))},A=t=>{r(s=>s.includes(t)?s.filter(i=>i!==t):[...s,t])},M=async()=>{if(a.length!==0)try{x(!0),(await h.deleteNotifications(a)).success?(f(s=>s.filter(i=>!a.includes(i._id))),r([]),g(!1),u(!1)):o("Failed to delete notifications")}catch(t){const s=t?.message||t?.toString()||"Failed to delete notifications";o(typeof s=="string"?s:"Failed to delete notifications")}finally{x(!1)}},R=()=>{u(!0),r([])},$=()=>{u(!1),r([])},E=async()=>{try{x(!0),(await h.deleteAllNotifications()).success?(f([]),r([]),g(!1)):o("Failed to delete all notifications")}catch(t){const s=t?.message||t?.toString()||"Failed to delete all notifications";o(typeof s=="string"?s:"Failed to delete all notifications")}finally{x(!1)}},_=t=>{const s=new Date(t),b=new Date-s,m=Math.floor(b/6e4),j=Math.floor(b/36e5),N=Math.floor(b/864e5);return m<1?"Just now":m<60?`${m} minute${m>1?"s":""} ago`:j<24?`${j} hour${j>1?"s":""} ago`:N<7?`${N} day${N>1?"s":""} ago`:s.toLocaleDateString()};return e.jsxs("div",{className:"min-h-screen w-full bg-white",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-4 sm:px-6 pt-4 sm:pt-6 pb-6 sm:pb-8",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 flex-1 min-w-0",children:[e.jsx("button",{onClick:()=>D(L.DASHBOARD),className:"p-2 text-white hover:bg-white/10 rounded-full transition-colors flex-shrink-0",children:e.jsx(I,{className:"text-xl sm:text-2xl"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold",children:"Notifications"}),l.length>0&&!d&&e.jsxs("p",{className:"text-sm text-white/80 mt-1",children:[l.length," notification",l.length>1?"s":""]}),d&&a.length>0&&e.jsxs("p",{className:"text-sm text-white/80 mt-1",children:[a.length," selected"]})]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:l.length>0&&e.jsx(e.Fragment,{children:d?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:$,className:"px-3 py-1.5 sm:py-2 text-white hover:bg-white/10 rounded-lg text-xs sm:text-sm font-semibold transition-colors border border-white/20",children:"Cancel"}),a.length>0&&e.jsx("button",{onClick:M,disabled:c,className:"px-3 py-1.5 sm:py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-xs sm:text-sm font-semibold transition-colors disabled:opacity-50 shadow-lg",children:c?"Deleting...":`Delete (${a.length})`})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:R,className:"p-2 text-white hover:bg-white/10 rounded-full transition-colors",title:"Select to Delete",children:e.jsx(T,{className:"text-lg sm:text-xl"})}),e.jsx("button",{onClick:w,disabled:p,className:"p-2 text-white hover:bg-white/10 rounded-full transition-colors disabled:opacity-50",title:"Refresh",children:e.jsx(z,{className:`text-lg sm:text-xl ${p?"animate-spin":""}`})})]})})})]})})}),e.jsxs("main",{className:"px-4 sm:px-6 py-6 pb-24",children:[v&&e.jsx("div",{className:"mb-4 bg-red-50 border-2 border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm font-medium",children:v}),p?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(t=>e.jsxs("div",{className:"bg-gray-50 rounded-xl p-5 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-3"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-full mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]},t))}):l.length>0?e.jsxs("div",{className:"space-y-3",children:[d&&e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("button",{onClick:C,className:"flex items-center gap-2 text-gray-700 hover:text-[var(--app-dark-blue)] transition-colors font-bold",children:[a.length===l.length?e.jsx(k,{className:"text-xl text-[var(--app-dark-blue)]"}):e.jsx(S,{className:"text-xl"}),e.jsx("span",{className:"text-sm",children:a.length===l.length?"Deselect All":"Select All"})]})}),l.map(t=>{const s=a.includes(t._id);return e.jsx("div",{className:`bg-white rounded-xl p-5 shadow-md border-2 transition-all ${d?"cursor-pointer":""} ${s?"border-[var(--app-dark-blue)] ring-2 ring-[var(--app-dark-blue)]/20 bg-blue-50":"border-gray-200 hover:border-[var(--app-dark-blue)]/30"} ${t.isRead?"":"bg-[var(--app-dark-blue)]/5"}`,onClick:()=>d&&A(t._id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[d&&e.jsx("div",{className:"mt-1",children:s?e.jsx(k,{className:"text-[var(--app-dark-blue)] text-xl"}):e.jsx(S,{className:"text-gray-300 text-xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:`font-bold text-base ${t.isRead?"text-gray-800":"text-[var(--app-dark-blue)]"}`,children:t.title}),!t.isRead&&e.jsx("span",{className:"w-2 h-2 bg-[var(--app-dark-blue)] rounded-full"})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-2 leading-relaxed",children:t.body}),e.jsx("p",{className:"text-gray-400 text-xs font-medium",children:_(t.createdAt)})]})]})},t._id)})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-200px)] py-12",children:[e.jsx("div",{className:"w-20 h-20 bg-[var(--app-dark-blue)]/10 rounded-full flex items-center justify-center mb-6",children:e.jsx(q,{className:"text-[var(--app-dark-blue)] text-4xl"})}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-2 text-center",children:"All Caught Up!"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md text-sm sm:text-base px-4 mb-6",children:"You don't have any notifications right now. We'll notify you when something important happens!"}),e.jsxs("div",{className:"bg-[var(--app-dark-blue)]/10 rounded-xl px-6 py-3 flex items-center gap-3 border border-[var(--app-dark-blue)]/20",children:[e.jsx("div",{className:"bg-[var(--app-dark-blue)] rounded-full p-1.5",children:e.jsx(H,{className:"text-white text-sm"})}),e.jsx("span",{className:"text-[var(--app-dark-blue)] font-bold text-sm",children:"You're up to date"})]})]})]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 px-4",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:"Delete All Notifications?"}),e.jsx("p",{className:"text-gray-600 mb-6 text-sm",children:"Are you sure you want to delete all notifications? This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>g(!1),disabled:c,className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-xl text-gray-700 font-bold hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:E,disabled:c,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors disabled:opacity-50",children:c?"Deleting...":"Delete All"})]})]})}),e.jsx(O,{})]})};export{J as default};
