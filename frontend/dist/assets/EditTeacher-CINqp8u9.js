import{u as w,q as N,r as x,j as e}from"./index-BPKQ2keO.js";import{t as f}from"./api-BdrZRD_7.js";const C=()=>{const m=w(),{id:u}=N(),[s,n]=x.useState({image:null,imagePreview:null,name:"",email:"",mobile:"",status:"Active",subjects:["",""]}),[l,h]=x.useState(!1),[p,g]=x.useState(!0),[b,o]=x.useState("");x.useEffect(()=>{u&&(async()=>{try{g(!0),o("");const a=await f.getById(u);if(a.success&&a.data?.teacher){const r=a.data.teacher,d=(r.subjects||[]).filter(c=>c&&typeof c=="string"&&c.trim().length>0).map(c=>c.trim()),i=["",""];d.length>0&&(i[0]=d[0]||"",d.length>1&&(i[1]=d[1]||"")),n({name:r.name||"",email:r.email||"",mobile:r.phone||"",status:r.isActive?"Active":"Inactive",imagePreview:r.profileImage||null,subjects:i})}else o("Teacher not found"),setTimeout(()=>m("/admin/teachers"),2e3)}catch(a){o(a.message||"Failed to load teacher"),console.error("Error fetching teacher:",a),setTimeout(()=>m("/admin/teachers"),2e3)}finally{g(!1)}})()},[u,m]);const j=t=>{const a=t.target.files[0];if(a){const r=new FileReader;r.onloadend=()=>{n({...s,image:a,imagePreview:r.result})},r.readAsDataURL(a)}},v=async t=>{t.preventDefault(),o(""),h(!0);try{const a=s.subjects.filter(i=>i&&i.trim().length>0).map(i=>i.trim());if(a.length>2){o("Maximum 2 subjects can be assigned to a teacher"),h(!1);return}const r={name:s.name,phone:s.mobile,email:s.email||void 0,isActive:s.status==="Active",subjects:a};s.imagePreview&&s.image&&(r.profileImageBase64=s.imagePreview);const d=await f.update(u,r);d.success?m("/admin/teachers"):o(d.message||"Failed to update teacher")}catch(a){o(a.message||"Failed to update teacher. Please try again."),console.error("Error updating teacher:",a)}finally{h(!1)}},y=t=>t?t.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2):"TE";return p?e.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 sm:h-10 sm:w-10 border-b-2 border-[#1e3a5f]"}),e.jsx("p",{className:"mt-2 sm:mt-3 text-gray-500 text-xs sm:text-sm",children:"Loading teacher data..."})]})}):e.jsx("div",{className:"min-h-screen bg-white",children:e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pt-2 sm:pt-3",children:[e.jsx("div",{className:"pb-1 sm:pb-2",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>m("/admin/teachers"),className:"text-[#1e3a5f] hover:text-[#2a4a6f] transition-colors",children:e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})}),e.jsx("h1",{className:"text-sm sm:text-base md:text-lg lg:text-xl font-bold text-[#1e3a5f]",children:"Edit Teacher"})]})}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-lg text-xs sm:text-sm mt-2 sm:mt-3",children:b}),e.jsx("div",{className:"mt-2 sm:mt-3",children:e.jsxs("form",{onSubmit:v,className:"space-y-3 sm:space-y-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-3 sm:p-4 md:p-5",children:e.jsx("div",{className:"flex items-center justify-center py-2 sm:py-3",children:e.jsxs("div",{className:"relative",children:[s.imagePreview?e.jsx("img",{src:s.imagePreview,alt:"Preview",className:"h-20 w-20 sm:h-24 sm:w-24 rounded-full object-cover border-4 border-[#1e3a5f] shadow-lg"}):e.jsx("div",{className:"h-20 w-20 sm:h-24 sm:w-24 rounded-full bg-gradient-to-br from-[#1e3a5f] to-[#2a4a6f] flex items-center justify-center border-4 border-[#1e3a5f] shadow-lg",children:e.jsx("span",{className:"text-white font-bold text-lg sm:text-xl",children:y(s.name)})}),e.jsxs("label",{className:"absolute bottom-0 right-0 bg-gradient-to-r from-[#1e3a5f] to-[#2a4a6f] hover:from-[#2a4a6f] hover:to-[#1e3a5f] text-white rounded-full p-2 sm:p-2.5 cursor-pointer transition-all duration-200 shadow-lg hover:shadow-xl",children:[e.jsxs("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:j,className:"hidden",disabled:l})]})]})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-3 sm:p-4 md:p-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:s.name,onChange:t=>n({...s,name:t.target.value}),className:"w-full px-3 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all duration-200",placeholder:"Enter full name",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:"Email"}),e.jsx("input",{type:"email",value:s.email,onChange:t=>n({...s,email:t.target.value}),className:"w-full px-3 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all duration-200",placeholder:"Enter email address",disabled:l})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Mobile ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"tel",required:!0,value:s.mobile,onChange:t=>n({...s,mobile:t.target.value}),className:"w-full px-3 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all duration-200",placeholder:"Enter mobile number with country code",disabled:l})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:s.status,onChange:t=>n({...s,status:t.target.value}),className:"w-full px-3 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all duration-200 bg-white",disabled:l,children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]})]}),e.jsxs("div",{className:"border-t-2 border-gray-100 pt-3 sm:pt-4 mt-3 sm:mt-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-2 sm:mb-3",children:["Assigned Subjects ",e.jsx("span",{className:"text-gray-500 text-xs",children:"(Maximum 2 - Enter subject names)"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[0,1].map(t=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-gray-600 mb-1.5 sm:mb-2",children:["Subject ",t+1]}),e.jsx("input",{type:"text",value:s.subjects[t]||"",onChange:a=>{const r=[...s.subjects];r[t]=a.target.value,n({...s,subjects:r})},className:"w-full px-3 py-2 text-xs sm:text-sm border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-[#1e3a5f] focus:border-[#1e3a5f] outline-none transition-all duration-200",placeholder:`Enter subject ${t+1} name`,disabled:l,maxLength:100})]},t))}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Enter subject names directly. These are independent of the Subjects module."})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-2 sm:gap-3 pt-3 sm:pt-4",children:[e.jsx("button",{type:"button",onClick:()=>m("/admin/teachers"),disabled:l,className:"w-full sm:w-auto px-4 sm:px-6 py-2 text-xs sm:text-sm border-2 border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-all duration-200 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"w-full sm:w-auto px-4 sm:px-6 py-2 text-xs sm:text-sm bg-gradient-to-r from-[#1e3a5f] to-[#2a4a6f] hover:from-[#2a4a6f] hover:to-[#1e3a5f] text-white rounded-lg font-semibold transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50",children:l?"Updating...":"Update Teacher"})]})]})})]})})};export{C as default};
