import{q as k,u as C,r as x,j as e,c as f,R as $,t as R,l as F,v as I,w as D,k as g,x as E,s as L}from"./index-BPKQ2keO.js";import{I as P}from"./Image-B5_LYj-X.js";import{B}from"./BottomNav-KrGopomG.js";const S=()=>{if(typeof window<"u"&&window.location.hostname.includes("dvisionacademy.com")){const r=window.location.hostname,o=window.location.protocol;return r.startsWith("www.")?`${o}//api.${r.substring(4)}`:r.startsWith("api.")?`${o}//${r}`:`${o}//api.${r}`}return"http://localhost:5000/api".replace("/api","")},W=()=>{const{id:r}=k(),o=C(),[t,w]=x.useState(null),[j,u]=x.useState(!0),[b,p]=x.useState("");x.useEffect(()=>{r&&(async()=>{try{u(!0),p("");const a=await L.getCourseById(r);a.success&&a.data?.course?w(a.data.course):p("Course not found")}catch(a){console.error("Error fetching course:",a),p(a.message||"Failed to load course details")}finally{u(!1)}})()},[r]);const v=async s=>{if(!s)return;const a=S(),N=!/^https?:\/\//i.test(s)&&!/^\/\//.test(s),y=/^\/\//.test(s);try{if(N||s.startsWith("/")){const l=s.replace(/^\/+/,""),n=`${a}/api/uploads/download?file=${encodeURIComponent(l)}`;window.location.href=n;return}if(y){const l=`${window.location.protocol}${s}`;if(l.includes(window.location.hostname)){const h=l.replace(`${window.location.protocol}//${window.location.hostname}`,"").replace(/^\/+/,""),c=`${a}/api/uploads/download?file=${encodeURIComponent(h)}`;window.location.href=c;return}s=l}if(/^https?:\/\//i.test(s)){if(new URL(s).hostname===window.location.hostname||s.includes(a)){const i=`${a}/api/uploads/download?url=${encodeURIComponent(s)}`;window.location.href=i;return}const n=await fetch(s);if(!n.ok)throw new Error("Failed to fetch file");const h=await n.blob(),c=n.headers.get("content-disposition");let m="file.pdf";if(c){const i=/filename\*=UTF-8''([^;\n]+)/i.exec(c)||/filename="?([^";\n]+)"?/i.exec(c);i&&i[1]&&(m=decodeURIComponent(i[1]))}else try{m=s.split("/").pop().split("?")[0]||m}catch{}const d=document.createElement("a");d.href=window.URL.createObjectURL(h),d.download=m,document.body.appendChild(d),d.click(),d.remove();return}}catch(l){console.error("Download error:",l),window.open(s,"_blank")}};return j?e.jsx("div",{className:"min-h-screen w-full bg-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-[var(--app-dark-blue)] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-base font-medium",children:"Loading course details..."})]})}):b||!t?e.jsx("div",{className:"min-h-screen w-full bg-white flex items-center justify-center px-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-800 text-lg font-bold mb-4",children:b||"Course not found"}),e.jsxs("button",{onClick:()=>o($.DASHBOARD),className:"bg-gradient-to-r from-[var(--app-dark-blue)] to-[var(--app-teal)] text-white px-8 py-3.5 rounded-xl font-bold hover:shadow-xl hover:scale-105 transition-all duration-300 shadow-lg flex items-center gap-2",children:[e.jsx(f,{className:"text-lg"}),e.jsx("span",{children:"Back to Dashboard"})]})]})}):e.jsxs("div",{className:"min-h-screen w-full bg-white",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-2 sm:px-3 pt-2 sm:pt-3 pb-2 sm:pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:()=>o("/my-courses"),className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(f,{className:"text-lg sm:text-xl"})}),e.jsx("button",{className:"p-1.5 sm:p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(R,{className:"text-lg sm:text-xl"})})]})})}),e.jsxs("main",{className:"pb-20 sm:pb-24",children:[e.jsx("div",{className:"relative mt-2 sm:mt-3 mb-3 sm:mb-4 overflow-hidden",children:e.jsxs("div",{className:"relative h-32 sm:h-40 md:h-44 w-full",children:[e.jsx(P,{src:t.thumbnail,alt:t.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"})]})}),e.jsxs("div",{className:"px-2 sm:px-3 md:px-4 space-y-2.5 sm:space-y-3",children:[e.jsx("div",{className:"mt-2 sm:mt-3",children:e.jsx("h1",{className:"text-base sm:text-lg md:text-xl font-bold text-gray-900 leading-tight",children:t.title})}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx(F,{className:"text-[var(--app-dark-blue)] text-sm sm:text-base flex-shrink-0"}),t.classId?e.jsx("span",{className:"text-purple-700 font-medium text-xs sm:text-sm bg-purple-50 px-2 py-1 rounded",children:t.classId.name||"Preparation Class"}):e.jsxs("span",{className:"text-gray-700 font-medium text-xs sm:text-sm",children:[t.board," Â· Class ",t.class]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx(I,{className:"text-[var(--app-dark-blue)] text-sm sm:text-base flex-shrink-0"}),e.jsxs("span",{className:"text-gray-700 font-medium text-xs sm:text-sm",children:["Subject: ",t.subject]})]}),t.description&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 via-[var(--app-dark-blue)]/5 to-[var(--app-teal)]/5 rounded-lg sm:rounded-xl p-2.5 sm:p-3 border border-[var(--app-dark-blue)]/20 shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-2 sm:mb-2.5",children:[e.jsx("div",{className:"p-1 sm:p-1.5 bg-gradient-to-br from-[var(--app-dark-blue)] to-[var(--app-teal)] rounded-lg shadow-sm flex-shrink-0",children:e.jsx(D,{className:"text-white text-xs sm:text-sm"})}),e.jsx("h3",{className:"font-bold text-gray-900 text-sm sm:text-base",children:"About This Course"})]}),e.jsx("p",{className:"text-gray-700 text-xs sm:text-sm leading-relaxed",children:t.description})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-3 sm:mb-4 flex-wrap",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-base sm:text-lg",children:"Course Chapters"}),t.chapters&&t.chapters.length>0&&e.jsxs("span",{className:"px-1.5 sm:px-2 py-0.5 bg-gradient-to-r from-[var(--app-dark-blue)]/10 to-[var(--app-teal)]/10 rounded-full text-[var(--app-dark-blue)] text-[10px] sm:text-xs font-semibold border border-[var(--app-dark-blue)]/20",children:[t.chapters.length," ",t.chapters.length===1?"Chapter":"Chapters"]})]}),!t.chapters||t.chapters.length===0?e.jsxs("div",{className:"text-center py-4 sm:py-6 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"w-12 h-12 sm:w-14 sm:h-14 mx-auto mb-2 sm:mb-3 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(g,{className:"text-gray-400 text-xl sm:text-2xl"})}),e.jsx("p",{className:"text-gray-600 text-xs sm:text-sm font-medium",children:"No chapters available for this course yet."}),e.jsx("p",{className:"text-gray-500 text-[10px] sm:text-xs mt-1",children:"Check back later for updates."})]}):e.jsx("div",{className:"space-y-2.5 sm:space-y-3",children:t.chapters.map((s,a)=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg sm:rounded-xl p-2.5 sm:p-3 shadow-md hover:shadow-lg hover:border-[var(--app-dark-blue)]/40 transition-all",children:e.jsxs("div",{className:"flex items-start gap-2.5 sm:gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 bg-gradient-to-br from-[var(--app-dark-blue)] to-[var(--app-teal)] rounded-full flex items-center justify-center shadow-sm",children:e.jsx("span",{className:"text-white font-bold text-[10px] sm:text-xs",children:s.chapterNumber||a+1})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-bold text-gray-900 text-xs sm:text-sm mb-1.5 leading-tight",children:s.chapterName}),s.chapterDetails&&e.jsx("p",{className:"text-gray-600 text-[10px] sm:text-xs mb-2.5 leading-relaxed",children:s.chapterDetails}),s.pdfUrl&&e.jsxs("button",{onClick:()=>v(s.pdfUrl),className:"bg-gradient-to-r from-red-600 to-red-700 hover:from-red-700 hover:to-red-600 text-white px-2.5 sm:px-3 py-1 sm:py-1.5 rounded-lg font-semibold text-[10px] sm:text-xs transition-all shadow-sm hover:shadow-md flex items-center justify-center gap-1 sm:gap-1.5 w-full sm:w-auto",children:[e.jsx(g,{className:"text-xs"}),e.jsx("span",{children:"Download PDF"}),e.jsx(E,{className:"text-xs"})]})]})]})},s._id||a))})]})]})]}),e.jsx(B,{})]})};export{W as default};
