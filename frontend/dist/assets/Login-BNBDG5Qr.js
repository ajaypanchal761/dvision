const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BPKQ2keO.js","assets/index-DMhs7ZgJ.css"])))=>i.map(i=>d[i]);
import{u as T,a as P,r as l,R as m,j as e,F as M,L as R,_ as D}from"./index-BPKQ2keO.js";import{l as E}from"./logo-BJrYxb4d.js";import{I as Q}from"./Image-B5_LYj-X.js";const O=()=>{const u=T(),{getCurrentUser:L}=P(),[o,f]=l.useState(""),[d,v]=l.useState(""),[w,y]=l.useState(!1),[h,j]=l.useState(!1),[c,r]=l.useState(""),[i,k]=l.useState("+91"),[N,b]=l.useState(!1),[g,x]=l.useState(!1),S=[{code:"+91",country:"India",countryCode:"IN",flag:"ðŸ‡®ðŸ‡³"},{code:"+1",country:"USA",countryCode:"US",flag:"ðŸ‡ºðŸ‡¸"},{code:"+44",country:"UK",countryCode:"GB",flag:"ðŸ‡¬ðŸ‡§"},{code:"+61",country:"Australia",countryCode:"AU",flag:"ðŸ‡¦ðŸ‡º"},{code:"+971",country:"UAE",countryCode:"AE",flag:"ðŸ‡¦ðŸ‡ª"}];l.useEffect(()=>{f("");const t=document.getElementById("mobile-number-login");t&&(t.value="")},[]),l.useEffect(()=>{const t=localStorage.getItem("dvision_token");if(t)try{const n=t.split(".")[1],s=JSON.parse(atob(n));(!s.role||s.role==="student")&&u(m.DASHBOARD,{replace:!0})}catch{}},[u]);const C=async t=>{if(t.preventDefault(),r(""),!o||o.length<10){r("Please enter a valid mobile number");return}y(!0)},I=async t=>{if(t.preventDefault(),r(""),!d||d.length<6){r("Please enter a valid password (minimum 6 characters)");return}j(!0);const n=`${i}${o}`;console.log("[Login] Starting login process..."),console.log("[Login] Phone number:",n);try{console.log("[Login] Importing studentAPI...");const{studentAPI:s}=await D(async()=>{const{studentAPI:p}=await import("./index-BPKQ2keO.js").then(A=>A.aM);return{studentAPI:p}},__vite__mapDeps([0,1]));console.log("[Login] Calling studentAPI.login...");const a=await s.login(n,d);if(console.log("[Login] API Response:",a),a.success){console.log("[Login] Success! Logging in..."),a.data?.token&&localStorage.setItem("dvision_token",a.data.token),a.data?.student&&localStorage.setItem("dvision_user",JSON.stringify(a.data.student));try{(await L()).success?window.location.href=m.DASHBOARD:u(m.DASHBOARD,{replace:!0})}catch(p){console.warn("Error updating auth context:",p),window.location.href=m.DASHBOARD}}else console.error("[Login] API returned success=false:",a),r(a.message||"Invalid phone number or password")}catch(s){console.error("[Login] Error occurred:",{message:s.message,name:s.name,errorType:s.constructor?.name,status:s.status,stack:s.stack,timestamp:new Date().toISOString()});let a=s.message||"Something went wrong. Please try again.";(s.message.includes("Network error")||s.message.includes("Failed to fetch"))&&(a+=" Please check your internet connection and ensure the backend server is running."),r(a)}finally{j(!1),console.log("[Login] Login process completed")}};return e.jsxs("div",{className:"min-h-screen w-full bg-white flex flex-col",children:[e.jsxs("div",{className:"bg-[var(--app-dark-blue)] text-white h-24 sm:h-28 md:h-32 relative overflow-hidden",style:{borderBottomRightRadius:"300px"},children:[e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-12 sm:h-14 md:h-16 overflow-hidden",children:e.jsxs("svg",{className:"absolute bottom-0 w-full h-full",viewBox:"0 0 1200 120",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0,60 Q300,20 600,60 T1200,60 L1200,120 L0,120 Z",fill:"rgba(255,255,255,0.1)",children:e.jsx("animate",{attributeName:"d",values:"M0,60 Q300,20 600,60 T1200,60 L1200,120 L0,120 Z;M0,60 Q300,40 600,60 T1200,60 L1200,120 L0,120 Z;M0,60 Q300,20 600,60 T1200,60 L1200,120 L0,120 Z",dur:"3s",repeatCount:"indefinite"})}),e.jsx("path",{d:"M0,80 Q300,40 600,80 T1200,80 L1200,120 L0,120 Z",fill:"rgba(255,255,255,0.05)",children:e.jsx("animate",{attributeName:"d",values:"M0,80 Q300,40 600,80 T1200,80 L1200,120 L0,120 Z;M0,80 Q300,60 600,80 T1200,80 L1200,120 L0,120 Z;M0,80 Q300,40 600,80 T1200,80 L1200,120 L0,120 Z",dur:"4s",repeatCount:"indefinite"})})]})}),e.jsx("div",{className:"absolute top-3 right-6 w-16 h-16 sm:w-20 sm:h-20 bg-white/10 rounded-full blur-xl"}),e.jsx("div",{className:"absolute top-8 right-16 w-12 h-12 sm:w-16 sm:h-16 bg-white/5 rounded-full blur-lg"}),e.jsx("div",{className:"absolute bottom-6 left-10 w-20 h-20 sm:w-24 sm:h-24 bg-white/10 rounded-full blur-xl"}),e.jsx("div",{className:"pt-5 sm:pt-6 md:pt-8 px-4 sm:px-6 md:px-8 relative z-10",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs sm:text-sm md:text-base text-white/90 mb-0.5 sm:mb-1",children:"Welcome back!"}),e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold text-white",children:"Sign In"})]})})]}),e.jsxs("div",{className:"flex-1 px-4 sm:px-6 md:px-8 py-4 sm:py-6 md:py-8 flex items-center justify-center relative overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-48 h-48 sm:w-64 sm:h-64 bg-[var(--app-dark-blue)]/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-60 h-60 sm:w-80 sm:h-80 bg-[var(--app-teal)]/5 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-72 h-72 sm:w-96 sm:h-96 bg-[var(--app-dark-blue)]/3 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"w-full max-w-md relative z-10",children:[e.jsx("div",{className:"mb-4 sm:mb-5 md:mb-6 flex justify-center",children:e.jsx(Q,{src:E,alt:"D'Vision Academy Logo",className:"h-28 sm:h-32 md:h-36 lg:h-40 w-auto object-contain"})}),w?e.jsxs("form",{onSubmit:I,autoComplete:"off",noValidate:!0,className:"space-y-4 sm:space-y-5 md:space-y-6",children:[e.jsxs("button",{type:"button",onClick:()=>{y(!1),v(""),r("")},className:"flex items-center gap-2 text-[var(--app-dark-blue)] hover:opacity-80 transition-opacity mb-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"text-sm font-medium",children:"Back"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg sm:rounded-xl p-3 sm:p-4 border-2 border-gray-200",children:[e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mb-1",children:"Phone Number"}),e.jsxs("p",{className:"text-sm sm:text-base font-semibold text-[var(--app-black)]",children:[i,o]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base md:text-lg font-medium text-[var(--app-black)] mb-2 sm:mb-3",children:"Password"}),e.jsx("input",{type:"password",placeholder:"Enter your password",value:d,onChange:t=>{v(t.target.value),r("")},onFocus:()=>x(!0),onBlur:()=>x(!1),autoComplete:"current-password",className:`w-full px-3 sm:px-4 md:px-5 py-3 sm:py-3.5 md:py-4 rounded-lg sm:rounded-xl border-2 transition-all text-sm sm:text-base md:text-lg text-[var(--app-black)] placeholder:text-gray-400 ${g?"border-[var(--app-dark-blue)] ring-2 ring-[var(--app-dark-blue)]/20":"border-gray-300"}`,required:!0,minLength:6})]}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-2.5 sm:px-3 md:px-4 py-2 sm:py-2.5 md:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm",children:c}),e.jsx("button",{type:"submit",className:"w-full bg-[var(--app-dark-blue)] text-white py-3 sm:py-4 md:py-4.5 rounded-lg sm:rounded-xl font-bold text-sm sm:text-base md:text-lg hover:opacity-90 transition-all duration-200 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:h||!d||d.length<6,children:h?"Signing In...":"Sign In"})]}):e.jsxs("form",{onSubmit:C,autoComplete:"off",noValidate:!0,className:"space-y-4 sm:space-y-5 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm sm:text-base md:text-lg font-medium text-[var(--app-black)] mb-2 sm:mb-3",children:"Mobile Number"}),e.jsxs("div",{className:`relative flex items-stretch rounded-lg sm:rounded-xl border transition-all ${g?"border-[var(--app-dark-blue)] ring-2 ring-[var(--app-dark-blue)]/20":"border-gray-300"}`,children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsxs("button",{type:"button",onClick:()=>b(!N),className:`flex items-center justify-center gap-1 sm:gap-1.5 px-3 sm:px-4 md:px-5 h-full rounded-l-lg sm:rounded-l-xl bg-gray-50 hover:bg-gray-100 transition-colors min-h-[48px] sm:min-h-[52px] md:min-h-[56px] w-auto ${g?"border-0":"border-r border-gray-300"}`,children:[e.jsx("span",{className:"text-[var(--app-black)]/70 font-medium text-sm sm:text-base md:text-lg whitespace-nowrap",children:i}),e.jsx(M,{className:"text-[var(--app-black)]/50 text-sm sm:text-base md:text-lg flex-shrink-0"})]}),N&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>b(!1)}),e.jsx("div",{className:"absolute top-full left-0 mt-1 bg-white border border-gray-300 rounded-lg sm:rounded-xl shadow-2xl z-20 max-h-60 overflow-y-auto w-44 sm:w-48 md:w-56",children:S.map(t=>e.jsxs("button",{type:"button",onClick:()=>{k(t.code),b(!1)},className:`w-full flex items-center gap-2 md:gap-3 px-2.5 sm:px-3 md:px-4 py-2 sm:py-2.5 md:py-3 hover:bg-gray-50 transition-colors ${i===t.code?"bg-[var(--app-dark-blue)]/10":""}`,children:[e.jsx("span",{className:"text-[var(--app-black)] font-bold text-xs sm:text-xs md:text-sm w-5 sm:w-6 md:w-8",children:t.countryCode}),e.jsx("span",{className:"text-[var(--app-black)] font-medium text-xs sm:text-xs md:text-sm",children:t.code}),e.jsx("span",{className:"text-[var(--app-black)]/60 text-[10px] sm:text-[10px] md:text-xs ml-auto",children:t.country})]},t.code))})]})]}),e.jsx("input",{type:"tel",name:"mobile-number-login",id:"mobile-number-login",placeholder:"Enter your mobile number",value:o,onChange:t=>{const n=t.target.value.replace(/\D/g,"").slice(0,15);f(n)},onFocus:()=>x(!0),onBlur:()=>x(!1),autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",spellCheck:"false",inputMode:"numeric",className:"flex-1 pl-3 sm:pl-4 md:pl-5 pr-3 sm:pr-4 md:pr-5 py-3 sm:py-3.5 md:py-4 rounded-r-lg sm:rounded-r-xl border-0 bg-gray-50 focus:outline-none focus:bg-white transition-all text-sm sm:text-base md:text-lg text-[var(--app-black)] placeholder:text-gray-400 h-full min-h-[48px] sm:min-h-[52px] md:min-h-[56px]",required:!0})]})]}),c&&!w&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-2.5 sm:px-3 md:px-4 py-2 sm:py-2.5 md:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm",children:[e.jsx("p",{className:"mb-1.5 sm:mb-2",children:c}),c.includes("don't have an account")&&e.jsx("button",{type:"button",onClick:()=>{const t=`${i}${o}`;sessionStorage.setItem("registration_phone",t),sessionStorage.setItem("registration_country_code",i),sessionStorage.setItem("registration_mobile",o),u(m.REGISTRATION)},className:"text-red-700 font-bold underline hover:text-red-800",children:"Sign Up"})]}),e.jsx("button",{type:"submit",className:"w-full bg-[var(--app-dark-blue)] text-white py-3 sm:py-4 md:py-4.5 rounded-lg sm:rounded-xl font-bold text-sm sm:text-base md:text-lg hover:opacity-90 transition-all duration-200 shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed",disabled:h||!o||o.length<10,children:"Continue"})]}),e.jsx("div",{className:"mt-6 sm:mt-8 md:mt-10 text-center",children:e.jsxs("p",{className:"text-xs sm:text-sm md:text-base text-[var(--app-black)]/80",children:["Don't have an account?"," ",e.jsx(R,{to:m.REGISTRATION,className:"text-[var(--app-teal)] font-bold underline hover:opacity-80",children:"Sign Up"})]})})]})]}),e.jsxs("div",{className:"bg-[var(--app-dark-blue)] h-16 sm:h-20 md:h-24 relative mt-auto overflow-hidden",style:{borderTopLeftRadius:"300px"},children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full overflow-hidden",children:e.jsxs("svg",{className:"absolute top-0 w-full h-full",viewBox:"0 0 1200 120",preserveAspectRatio:"none",children:[e.jsx("path",{d:"M0,40 Q300,80 600,40 T1200,40 L1200,0 L0,0 Z",fill:"rgba(255,255,255,0.1)",children:e.jsx("animate",{attributeName:"d",values:"M0,40 Q300,80 600,40 T1200,40 L1200,0 L0,0 Z;M0,40 Q300,60 600,40 T1200,40 L1200,0 L0,0 Z;M0,40 Q300,80 600,40 T1200,40 L1200,0 L0,0 Z",dur:"3s",repeatCount:"indefinite"})}),e.jsx("path",{d:"M0,20 Q300,60 600,20 T1200,20 L1200,0 L0,0 Z",fill:"rgba(255,255,255,0.05)",children:e.jsx("animate",{attributeName:"d",values:"M0,20 Q300,60 600,20 T1200,20 L1200,0 L0,0 Z;M0,20 Q300,40 600,20 T1200,20 L1200,0 L0,0 Z;M0,20 Q300,60 600,20 T1200,20 L1200,0 L0,0 Z",dur:"4s",repeatCount:"indefinite"})})]})}),e.jsx("div",{className:"absolute bottom-3 left-6 w-16 h-16 sm:w-20 sm:h-20 bg-white/10 rounded-full blur-xl"}),e.jsx("div",{className:"absolute bottom-8 left-16 w-12 h-12 sm:w-16 sm:h-16 bg-white/5 rounded-full blur-lg"}),e.jsx("div",{className:"absolute top-6 right-10 w-20 h-20 sm:w-24 sm:h-24 bg-white/10 rounded-full blur-xl"})]})]})};export{O as default};
