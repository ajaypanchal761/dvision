import{u as $,r as x,j as e,c as C,m as h,i as w,l as k}from"./index-BPKQ2keO.js";import{c as M}from"./api-CVReUq8b.js";import{B as O}from"./BottomNav-BGePCkyK.js";const W=()=>{const S=$(),[p,T]=x.useState([]),[D,g]=x.useState(!0),[b,u]=x.useState(""),[l,f]=x.useState(null),d=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],m=d[new Date().getDay()===0?6:new Date().getDay()-1];x.useEffect(()=>{(async()=>{try{g(!0),u("");const t=await M.getMySchedule();t.success&&t.data?.timetables?T(t.data.timetables||[]):u("Failed to load schedule")}catch(t){console.error("Error fetching schedule:",t),u(t.message||"Failed to load schedule")}finally{g(!1)}})()},[]);const o=s=>{if(!s)return"N/A";const[t,a]=s.split(":"),r=parseInt(t),n=r>=12?"PM":"AM";return`${r%12||12}:${a} ${n}`},j=s=>p.filter(t=>t.dayOfWeek===s).sort((t,a)=>{const[r,n]=t.startTime.split(":").map(Number),[c,i]=a.startTime.split(":").map(Number);return r*60+n-(c*60+i)}),y=l?j(l):p.sort((s,t)=>{const a=d.indexOf(s.dayOfWeek)-d.indexOf(t.dayOfWeek);if(a!==0)return a;const[r,n]=s.startTime.split(":").map(Number),[c,i]=t.startTime.split(":").map(Number);return r*60+n-(c*60+i)}),N=s=>s?s.type==="preparation"?s.name:`Class ${s.class} - ${s.board}`:"N/A",v=(s,t)=>{if(!s||t!==m)return!1;const a=new Date,[r,n]=s.split(":").map(Number),c=new Date;c.setHours(r,n,0,0);const i=c-a;return i>=0&&i<=1800*1e3};return e.jsxs("div",{className:"min-h-screen w-full bg-white pb-20",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-4 sm:px-6 pt-3 sm:pt-4 pb-4 sm:pb-5",children:e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[e.jsx("button",{onClick:()=>S("/teacher/live-classes"),className:"p-2 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(C,{className:"text-lg sm:text-xl"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"My Schedule"}),e.jsx("p",{className:"text-xs sm:text-sm text-white/90 mt-0.5",children:"View your assigned classes"})]})]})})}),e.jsxs("main",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-4 sm:py-5",children:[e.jsx("div",{className:"mb-4 sm:mb-5",children:e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-2",children:[e.jsx("button",{onClick:()=>f(null),className:`px-3 py-1.5 rounded-lg text-xs sm:text-sm font-medium whitespace-nowrap transition-all ${l===null?"bg-[var(--app-dark-blue)] text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Days"}),d.map(s=>e.jsxs("button",{onClick:()=>f(s),className:`px-3 py-1.5 rounded-lg text-xs sm:text-sm font-medium whitespace-nowrap transition-all ${l===s?"bg-[var(--app-dark-blue)] text-white":s===m?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[s.substring(0,3),s===m&&e.jsx("span",{className:"ml-1",children:"•"})]},s))]})}),D?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px]",children:[e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-[var(--app-dark-blue)] mb-3"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Loading schedule..."})]}):b?e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] bg-white rounded-xl p-6",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(h,{className:"text-red-600 text-2xl"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:"Error Loading Schedule"}),e.jsx("p",{className:"text-gray-500 text-center text-sm mb-4",children:b}),e.jsx("button",{onClick:()=>window.location.reload(),className:"bg-[var(--app-dark-blue)] text-white px-4 py-2 rounded-lg text-sm font-medium",children:"Retry"})]}):y.length>0?e.jsx("div",{className:"space-y-3 sm:space-y-4",children:l?e.jsxs("div",{children:[e.jsx("h2",{className:"text-base sm:text-lg font-bold text-gray-800 mb-3 sm:mb-4",children:l}),e.jsx("div",{className:"space-y-3",children:y.map(s=>{const t=v(s.startTime,s.dayOfWeek);return e.jsx("div",{className:`bg-white rounded-xl p-4 sm:p-5 shadow-md border-2 transition-all ${t?"border-green-500 bg-green-50":"border-gray-200 hover:shadow-lg"}`,children:e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[s.thumbnail&&e.jsx("div",{className:"flex-shrink-0 w-16 h-16 sm:w-20 sm:h-20 rounded-lg overflow-hidden",children:e.jsx("img",{src:s.thumbnail,alt:s.subjectId?.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-800",children:s.subjectId?.name||"Subject"}),t&&e.jsx("span",{className:"text-xs bg-green-500 text-white px-2 py-0.5 rounded-full font-medium",children:"Starting Soon"}),s.topic&&e.jsxs("span",{className:"text-xs text-gray-500",children:["• ",s.topic]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-gray-600",children:[e.jsx(w,{className:"text-[var(--app-dark-blue)]"}),e.jsx("span",{children:N(s.classId)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-gray-600",children:[e.jsx(h,{className:"text-[var(--app-dark-blue)]"}),e.jsxs("span",{children:[o(s.startTime)," - ",o(s.endTime)]})]})]})]})]})},s._id)})})]}):d.map(s=>{const t=j(s);return t.length===0?null:e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-5 shadow-md border border-gray-200",children:[e.jsxs("h2",{className:"text-base sm:text-lg font-bold text-gray-800 mb-3 sm:mb-4 flex items-center gap-2",children:[e.jsx(k,{className:"text-[var(--app-dark-blue)]"}),s,s===m&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full font-medium",children:"Today"})]}),e.jsx("div",{className:"space-y-3",children:t.map(a=>{const r=v(a.startTime,a.dayOfWeek);return e.jsx("div",{className:`bg-gray-50 rounded-lg p-3 sm:p-4 border-2 transition-all ${r?"border-green-500 bg-green-50":"border-gray-100"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[a.thumbnail&&e.jsx("div",{className:"flex-shrink-0 w-12 h-12 sm:w-16 sm:h-16 rounded-lg overflow-hidden",children:e.jsx("img",{src:a.thumbnail,alt:a.subjectId?.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-sm sm:text-base font-bold text-gray-800",children:a.subjectId?.name||"Subject"}),r&&e.jsx("span",{className:"text-xs bg-green-500 text-white px-2 py-0.5 rounded-full font-medium",children:"Soon"}),a.topic&&e.jsxs("span",{className:"text-xs text-gray-500",children:["• ",a.topic]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx(w,{className:"text-[var(--app-dark-blue)] text-xs"}),e.jsx("span",{children:N(a.classId)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx(h,{className:"text-[var(--app-dark-blue)] text-xs"}),e.jsxs("span",{children:[o(a.startTime)," - ",o(a.endTime)]})]})]})]})]})},a._id)})})]},s)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] bg-white rounded-xl p-6 sm:p-8",children:[e.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-[var(--app-dark-blue)]/10 rounded-full flex items-center justify-center mb-4",children:e.jsx(k,{className:"text-[var(--app-dark-blue)] text-2xl sm:text-3xl"})}),e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-800 mb-2",children:"No Schedule Available"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md text-xs sm:text-sm",children:l?`No classes scheduled for ${l}`:"You have not been assigned to any classes yet. Please contact your administrator."})]})]}),e.jsx(O,{})]})};export{W as default};
