import{u as w,q as T,r,j as e}from"./index-BPKQ2keO.js";import{h}from"./api-BdrZRD_7.js";const A=()=>{const n=w(),{id:o}=T(),[a,m]=r.useState({startTime:"",endTime:"",thumbnail:"",topic:"",isActive:!0}),[d,f]=r.useState(null),[c,p]=r.useState(""),[v,g]=r.useState(!0),[b,u]=r.useState(!1),[x,l]=r.useState("");r.useEffect(()=>{o&&(async()=>{try{g(!0),l("");const i=await h.getById(o);if(i.success&&i.data?.timetable){const s=i.data.timetable;f(s),m({startTime:s.startTime||"",endTime:s.endTime||"",thumbnail:s.thumbnail||"",topic:s.topic||"",isActive:s.isActive!==void 0?s.isActive:!0}),s.thumbnail&&p(s.thumbnail)}else l("Timetable not found")}catch(i){console.error("Error fetching timetable:",i),l(i.message||"Failed to load timetable")}finally{g(!1)}})()},[o]);const y=t=>{const i=t.target.files[0];if(i){const s=new FileReader;s.onloadend=()=>{p(s.result),m({...a,thumbnail:s.result})},s.readAsDataURL(i)}},j=async t=>{if(t.preventDefault(),l(""),u(!0),a.startTime>=a.endTime){l("End time must be after start time"),u(!1);return}const i={startTime:a.startTime,endTime:a.endTime,thumbnail:a.thumbnail||void 0,topic:a.topic||void 0,isActive:a.isActive};try{const s=await h.update(o,i);s.success?n("/admin/timetable"):l(s.message||"Failed to update timetable")}catch(s){console.error("Error updating timetable:",s),l(s.message||"Failed to update timetable. Please try again.")}finally{u(!1)}},N=t=>t?t.type==="preparation"?t.name:`Class ${t.class} - ${t.board}`:"N/A";return v?e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-dvision-blue mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"Loading timetable..."})]})}):x&&!d?e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-500 font-medium mb-4",children:x}),e.jsx("button",{onClick:()=>n("/admin/timetable"),className:"px-4 py-2 bg-dvision-blue text-white rounded-lg font-semibold",children:"Back to Timetable"})]})}):e.jsx("div",{className:"min-h-screen bg-gray-100",children:e.jsxs("div",{className:"px-2 sm:px-3 md:px-4 lg:px-6 xl:px-8 pt-3 sm:pt-4 md:pt-5 lg:pt-6",children:[e.jsx("div",{className:"px-2 sm:px-3 md:px-4 lg:px-6 xl:px-8 pb-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4 sm:mb-5 md:mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold text-gray-900",children:"Edit Timetable"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:"Update timetable information"})]}),e.jsxs("button",{onClick:()=>n("/admin/timetable"),className:"px-3 sm:px-4 md:px-5 lg:px-6 py-2 sm:py-2.5 md:py-3 border-2 border-gray-300 text-gray-700 rounded-lg sm:rounded-xl font-semibold text-xs sm:text-sm md:text-base transition-all duration-200 flex items-center justify-center space-x-2 hover:bg-gray-50",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"Back"})]})]})}),x&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 sm:px-4 py-2 sm:py-3 rounded-lg sm:rounded-xl text-xs sm:text-sm mb-3 sm:mb-4",children:x}),e.jsx("div",{className:"px-2 sm:px-3 md:px-4 lg:px-6 xl:px-8",children:e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl md:rounded-2xl shadow-lg border border-gray-100 p-4 sm:p-5 md:p-6 lg:p-8",children:[e.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-gray-700 mb-4",children:"Timetable Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-500 mb-1",children:"Class"}),e.jsx("p",{className:"text-sm sm:text-base font-semibold text-gray-900",children:N(d?.classId)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-500 mb-1",children:"Subject"}),e.jsx("p",{className:"text-sm sm:text-base font-semibold text-gray-900",children:d?.subjectId?.name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-500 mb-1",children:"Teacher"}),e.jsx("p",{className:"text-sm sm:text-base font-semibold text-gray-900",children:d?.teacherId?.name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm font-medium text-gray-500 mb-1",children:"Day of Week"}),e.jsx("p",{className:"text-sm sm:text-base font-semibold text-gray-900",children:d?.dayOfWeek||"N/A"})]})]})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4 sm:space-y-5 md:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-5 lg:gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm md:text-base font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Start Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"time",required:!0,value:a.startTime,onChange:t=>m({...a,startTime:t.target.value}),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 text-xs sm:text-sm md:text-base border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm md:text-base font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["End Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"time",required:!0,value:a.endTime,onChange:t=>m({...a,endTime:t.target.value}),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 text-xs sm:text-sm md:text-base border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm md:text-base font-semibold text-gray-700 mb-1.5 sm:mb-2",children:"Topic"}),e.jsx("input",{type:"text",value:a.topic,onChange:t=>m({...a,topic:t.target.value}),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 text-xs sm:text-sm md:text-base border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200",placeholder:"Enter topic (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs sm:text-sm md:text-base font-semibold text-gray-700 mb-1.5 sm:mb-2",children:"Status"}),e.jsxs("select",{value:a.isActive?"active":"inactive",onChange:t=>m({...a,isActive:t.target.value==="active"}),className:"w-full px-3 sm:px-4 py-2.5 sm:py-3 text-xs sm:text-sm md:text-base border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200 bg-white",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs sm:text-sm md:text-base font-semibold text-gray-700 mb-1.5 sm:mb-2",children:"Thumbnail"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4",children:[c?e.jsx("img",{src:c,alt:"Preview",className:"h-20 w-20 sm:h-24 sm:w-24 object-cover rounded-lg sm:rounded-xl border-2 border-gray-200"}):e.jsx("div",{className:"h-20 w-20 sm:h-24 sm:w-24 bg-gray-100 rounded-lg sm:rounded-xl border-2 border-dashed border-gray-300 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 sm:w-10 sm:w-10 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsxs("label",{className:"flex-1 w-full sm:w-auto cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:y,className:"hidden"}),e.jsx("div",{className:"w-full sm:w-auto px-4 sm:px-6 py-2.5 sm:py-3 border-2 border-dvision-blue text-dvision-blue rounded-lg sm:rounded-xl font-semibold hover:bg-dvision-blue-lightestBg transition-all duration-200 text-center text-xs sm:text-sm md:text-base",children:c?"Change Image":"Upload Thumbnail"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3 sm:gap-4 pt-4 sm:pt-6 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>n("/admin/timetable"),className:"w-full sm:w-auto px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 text-xs sm:text-sm md:text-base border-2 border-gray-300 text-gray-700 rounded-lg sm:rounded-xl font-semibold hover:bg-gray-50 transition-all duration-200",disabled:b,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,className:"w-full sm:w-auto px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 text-xs sm:text-sm md:text-base bg-dvision-blue hover:bg-dvision-blue-dark text-white rounded-lg sm:rounded-xl font-semibold transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Updating...":"Update Timetable"})]})]})]})})]})})};export{A as default};
