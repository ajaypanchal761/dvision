import{u as R,r as a,p as h,j as e,c as b,R as S,l as D,m as C,D as f}from"./index-BPKQ2keO.js";import{B as U}from"./BottomNav-KrGopomG.js";const A=()=>{const j=R(),[o,l]=a.useState([]),[v,c]=a.useState(!0),[x,m]=a.useState(""),[p,n]=a.useState(null),[u,d]=a.useState(""),[E,N]=a.useState(null);a.useEffect(()=>{y()},[]);const y=async()=>{try{c(!0),m("");const s=await h.getRecordings();s.success&&s.data?.recordings?(l(s.data.recordings),console.log("[Recordings] Loaded recordings:",s.data.recordings.length)):l([])}catch(s){console.error("Error fetching recordings:",s),m(s.message||"Failed to load recordings"),l([])}finally{c(!1)}},w=async s=>{try{if(s.playbackUrl){n(s),d(s.playbackUrl);return}const t=await h.getRecording(s._id);if(t.success&&t.data?.recording){const r=t.data.recording;n(r),d(r.playbackUrl||r.s3Url)}else alert("Recording is not available. Please try again later.")}catch(t){console.error("Error loading recording:",t),alert(t.message||"Failed to load recording")}},i=s=>{if(!s)return"N/A";const t=Math.floor(s/3600),r=Math.floor(s%3600/60),g=s%60;return t>0?`${t}:${String(r).padStart(2,"0")}:${String(g).padStart(2,"0")}`:`${r}:${String(g).padStart(2,"0")}`},k=s=>new Date(s).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"});return e.jsxs("div",{className:"min-h-screen w-full bg-white",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-[var(--app-dark-blue)] text-white relative",style:{borderRadius:"0 0 50% 50% / 0 0 30px 30px"},children:e.jsx("div",{className:"px-4 sm:px-6 pt-3 sm:pt-4 pb-4 sm:pb-5",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("button",{onClick:()=>j(S.DASHBOARD),className:"p-1.5 text-white hover:bg-white/10 rounded-full transition-colors",children:e.jsx(b,{className:"text-lg sm:text-xl"})}),e.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold",children:"Recordings"})]})})}),e.jsxs("main",{className:"px-4 sm:px-6 py-4 sm:py-5 pb-24",children:[x&&e.jsx("div",{className:"mb-4 bg-red-50 border-2 border-red-200 text-red-700 px-4 py-3 rounded-xl text-sm",children:x}),v?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--app-dark-blue)]"})}):o.length>0?e.jsx("div",{className:"space-y-3 sm:space-y-4",children:o.map(s=>e.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl p-3 sm:p-4 shadow-md hover:shadow-lg transition-all border border-gray-200",children:e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base sm:text-lg font-bold text-gray-800 mb-1.5",children:s.title}),e.jsxs("p",{className:"text-gray-600 text-xs sm:text-sm mb-2.5 font-medium",children:[s.subjectId?.name||"Subject"," Â· ",s.teacherId?.name||"Teacher"]}),s.description&&e.jsx("p",{className:"text-gray-500 text-xs sm:text-sm mb-2.5",children:s.description}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"p-1 bg-[var(--app-dark-blue)]/10 rounded-lg",children:e.jsx(D,{className:"text-[var(--app-dark-blue)] text-xs"})}),e.jsx("span",{className:"font-medium",children:k(s.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"p-1 bg-[var(--app-dark-blue)]/10 rounded-lg",children:e.jsx(C,{className:"text-[var(--app-dark-blue)] text-xs"})}),e.jsx("span",{className:"font-medium",children:i(s.duration)})]})]})]}),e.jsxs("button",{onClick:()=>w(s),className:"bg-[var(--app-dark-blue)] text-white font-bold px-3 sm:px-4 py-2 sm:py-2.5 rounded-lg sm:rounded-xl hover:bg-[var(--app-dark-blue)]/90 transition-colors flex items-center gap-1.5 shadow-md ml-2 sm:ml-3 text-xs sm:text-sm",children:[e.jsx(f,{className:"text-xs"}),e.jsx("span",{children:"Play"})]})]})},s._id))}):e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[50vh] py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-[var(--app-dark-blue)]/10 rounded-full flex items-center justify-center mb-4",children:e.jsx(f,{className:"text-[var(--app-dark-blue)] text-3xl"})}),e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-800 mb-1.5 text-center",children:"No recordings available"}),e.jsx("p",{className:"text-gray-500 text-center max-w-md text-xs sm:text-sm",children:"Recordings from your live classes will appear here"})]})]}),p&&u&&e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-xl p-4 max-w-4xl w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-white font-bold text-lg",children:p.title}),e.jsx("button",{onClick:()=>{n(null),d("")},className:"text-white hover:bg-gray-800 p-2 rounded-lg",children:e.jsx(b,{className:"text-xl"})})]}),e.jsx("video",{ref:N,src:u,controls:!0,controlsList:"nodownload",preload:"metadata",className:"w-full rounded-lg",style:{maxHeight:"70vh",backgroundColor:"#000"},onLoadedMetadata:s=>{const t=s.target;t.duration&&!isNaN(t.duration)&&(console.log("[Video] Duration loaded:",i(t.duration)),t.controls=!0)},onCanPlay:s=>{const t=s.target;t.duration&&!isNaN(t.duration)&&console.log("[Video] Can play - Duration:",i(t.duration))},onTimeUpdate:s=>{const t=s.target;t.currentTime,t.duration},children:"Your browser does not support the video tag."})]})}),e.jsx(U,{})]})};export{A as default};
