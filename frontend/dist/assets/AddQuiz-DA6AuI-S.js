import{u as S,r as i,j as e}from"./index-BPKQ2keO.js";import{c as k,e as z,q as A}from"./api-BdrZRD_7.js";const O=()=>{const c=S(),[t,o]=i.useState({name:"",classNumber:"",board:"",subjectId:"",numberOfQuestions:""}),[l,d]=i.useState([]),[u,h]=i.useState([]),[g,x]=i.useState([]),[b,p]=i.useState(!1);i.useEffect(()=>{f()},[]),i.useEffect(()=>{t.classNumber&&t.board?j():(x([]),o(s=>({...s,subjectId:""})))},[t.classNumber,t.board]);const f=async()=>{try{const s=await k.getAllWithoutPagination({isActive:!0});s.success&&s.data.classes&&h(s.data.classes)}catch(s){console.error("Error fetching classes:",s)}},j=async()=>{try{const s=await z.getAll({class:t.classNumber,board:t.board});s.success&&s.data.subjects&&x(s.data.subjects)}catch(s){console.error("Error fetching subjects:",s)}},y=()=>{const s=new Set;return u.forEach(r=>{r.board&&s.add(r.board)}),Array.from(s)},v=s=>{const r=parseInt(s)||0;if(r<0){o({...t,numberOfQuestions:""}),d([]);return}o({...t,numberOfQuestions:s});const a=[];for(let n=0;n<r;n++)l[n]?a.push(l[n]):a.push({question:"",options:["","","",""],correctAnswer:0});d(a)},N=(s,r,a)=>{const n=[...l];n[s][r]=a,d(n)},w=(s,r,a)=>{const n=[...l];n[s].options[r]=a,d(n)},q=(s,r)=>{const a=[...l];a[s].correctAnswer=parseInt(r),d(a)},C=()=>{if(!t.name.trim())return alert("Please enter quiz name"),!1;if(!t.classNumber)return alert("Please select a class"),!1;if(!t.board)return alert("Please select a board"),!1;if(!t.subjectId)return alert("Please select a subject"),!1;if(!t.numberOfQuestions||parseInt(t.numberOfQuestions)<1)return alert("Please enter number of questions"),!1;if(l.length===0)return alert("Please add at least one question"),!1;for(let s=0;s<l.length;s++){const r=l[s];if(!r.question.trim())return alert(`Please enter question ${s+1}`),!1;for(let a=0;a<4;a++)if(!r.options[a]||!r.options[a].trim())return alert(`Please enter all 4 options for question ${s+1}`),!1}return!0},Q=async s=>{if(s.preventDefault(),!!C())try{p(!0);const r={name:t.name.trim(),classNumber:parseInt(t.classNumber),board:t.board,subjectId:t.subjectId,questions:l.map(n=>({question:n.question.trim(),options:n.options.map(m=>m.trim()),correctAnswer:n.correctAnswer}))};(await A.create(r)).success&&(alert("Quiz created successfully!"),c("/admin/quiz"))}catch(r){console.error("Error creating quiz:",r),alert(r.message||"Failed to create quiz. Please try again.")}finally{p(!1)}};return e.jsx("div",{className:"min-h-screen bg-gray-100",children:e.jsxs("div",{className:"px-2 sm:px-3 md:px-4 lg:px-6 xl:px-8 pt-3 sm:pt-4 md:pt-5 lg:pt-6",children:[e.jsx("div",{className:"px-2 sm:px-3 md:px-4 lg:px-6 xl:px-8 pb-0",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-base sm:text-lg md:text-xl lg:text-2xl font-bold text-gray-900",children:"Add New Quiz"})}),e.jsxs("button",{onClick:()=>c("/admin/quiz"),className:"px-3 sm:px-4 md:px-5 py-2 sm:py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-lg sm:rounded-xl font-semibold text-xs sm:text-sm md:text-base transition-all duration-200 flex items-center justify-center space-x-2",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{children:"Back"})]})]})}),e.jsx("div",{className:"mt-3 sm:mt-4 md:mt-5 lg:mt-6",children:e.jsxs("form",{onSubmit:Q,className:"space-y-4 sm:space-y-5 md:space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Quiz Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",required:!0,value:t.name,onChange:s=>o({...t,name:s.target.value}),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 md:py-3 border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200 text-sm sm:text-base",placeholder:"Enter quiz name"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Class ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:t.classNumber,onChange:s=>{o({...t,classNumber:s.target.value,board:"",subjectId:""})},className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 md:py-3 border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200 bg-white text-sm sm:text-base",children:[e.jsx("option",{value:"",children:"Select Class"}),u.map(s=>e.jsxs("option",{value:s.classNumber,children:["Class ",s.classNumber]},s._id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Board ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:t.board,onChange:s=>{o({...t,board:s.target.value,subjectId:""})},disabled:!t.classNumber,className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 md:py-3 border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200 bg-white text-sm sm:text-base disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select Board"}),y().map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Subject ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{required:!0,value:t.subjectId,onChange:s=>o({...t,subjectId:s.target.value}),disabled:!t.board,className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 md:py-3 border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200 bg-white text-sm sm:text-base disabled:bg-gray-100 disabled:cursor-not-allowed",children:[e.jsx("option",{value:"",children:"Select Subject"}),g.map(s=>e.jsx("option",{value:s._id,children:s.name},s._id))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Number of Questions ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",required:!0,min:"1",value:t.numberOfQuestions,onChange:s=>v(s.target.value),className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 md:py-3 border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200 text-sm sm:text-base",placeholder:"Enter number of questions"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter the total number of questions you want to add to this quiz"})]}),t.numberOfQuestions&&parseInt(t.numberOfQuestions)>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsxs("h2",{className:"text-sm sm:text-base md:text-lg font-bold text-gray-900",children:["Questions (",l.length,")"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Fill in all questions with their options and select the correct answer for each"})]}),e.jsx("div",{className:"space-y-4 sm:space-y-5",children:l.map((s,r)=>e.jsxs("div",{className:"bg-white rounded-xl p-4 sm:p-5 md:p-6 border-2 border-gray-200",children:[e.jsx("div",{className:"mb-3 sm:mb-4",children:e.jsxs("h3",{className:"text-sm sm:text-base font-semibold text-gray-900",children:["Question ",r+1]})}),e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Question Text ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{required:!0,value:s.question,onChange:a=>N(r,"question",a.target.value),rows:"3",className:"w-full px-3 sm:px-4 py-2 sm:py-2.5 md:py-3 border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200 resize-none text-sm sm:text-base",placeholder:"Enter your question here..."})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3 mb-3 sm:mb-4",children:[e.jsxs("label",{className:"block text-xs sm:text-sm font-semibold text-gray-700 mb-1.5 sm:mb-2",children:["Options ",e.jsx("span",{className:"text-red-500",children:"*"})]}),s.options.map((a,n)=>e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("input",{type:"radio",name:`correctAnswer-${r}`,checked:s.correctAnswer===n,onChange:()=>q(r,n),className:"w-4 h-4 sm:w-5 sm:h-5 text-dvision-blue focus:ring-dvision-blue cursor-pointer"}),e.jsx("input",{type:"text",required:!0,value:a,onChange:m=>w(r,n,m.target.value),className:"flex-1 px-3 sm:px-4 py-2 sm:py-2.5 border-2 border-gray-200 rounded-lg sm:rounded-xl focus:ring-2 focus:ring-dvision-blue focus:border-dvision-blue outline-none transition-all duration-200 text-sm sm:text-base",placeholder:`Option ${n+1}`})]},n))]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select the radio button next to the correct answer"})]},r))})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-end gap-3 sm:gap-4 pt-4 sm:pt-6",children:[e.jsx("button",{type:"button",onClick:()=>c("/admin/quiz"),className:"w-full sm:w-auto px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 text-xs sm:text-sm md:text-base border-2 border-gray-300 text-gray-700 rounded-lg sm:rounded-xl font-semibold hover:bg-gray-50 transition-all duration-200",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,className:"w-full sm:w-auto px-4 sm:px-6 md:px-8 py-2.5 sm:py-3 text-xs sm:text-sm md:text-base bg-dvision-blue hover:bg-dvision-blue-dark text-white rounded-lg sm:rounded-xl font-semibold transition-all duration-200 shadow-md hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Creating...":"Create Quiz"})]})]})})]})})};export{O as default};
